{"version":3,"sources":["helpers/UsersGraphQL.js","components/nav/UserProfile.js","components/hooks/useProfile.js","components/nav/NavBar.js","helpers/ReportsGraphQL.js","components/graph/BarGraph.js","helpers/ColorsHelper.js","pages/dashboard/ComplaintsByNatureGraph.js","components/graph/PieChart.js","pages/dashboard/ComplaintsByStatusGraph.js","pages/dashboard/ComplaintsByLocationGraph.js","pages/dashboard/ComplaintsKPIGraph.js","components/forms/Input.js","components/forms/Select.js","components/forms/FilterExport.js","helpers/Dates.js","pages/dashboard/FilterForm.js","pages/HomePage.js","components/tables/Table.js","components/icons/MatIcon.js","helpers/GraphQL.js","helpers/FileUpload.js","constants.js","pages/complaints/NewComplaintRegisterPage.js","components/modals/Modal.js","pages/complaints/AssignComplaintPopup.js","pages/complaints/UpdateComplaintForm.js","components/tables/Pagination.js","pages/complaints/FeedbackForm.js","conf.js","pages/complaints/Attachment.js","pages/complaints/ComplaintAttachements.js","pages/complaints/ComplaintDetailViewPage.js","pages/complaints/FilterForm.js","pages/ComplaintsPage.js","pages/users/NewUserPage.js","pages/users/UpdateUserPage.js","pages/UserManagementPage.js","helpers/AuthHelper.js","pages/LoginPage.js","components/modals/Modal_.js","pages/users/ChangePasswordForm.js","pages/users/UserProfilePage.js","App.js","serviceWorker.js","index.js"],"names":["USERS_GET_TOKEN","gql","USERS_GET_ME","USERS","REGISTER_USER","GET_USER","CHANGE_PASSWORD","UserProfile","props","useQuery","loading","error","data","console","log","className","exact","to","me","username","useProfile","history","useHistory","graphQLErrors","length","message","push","NavBar","user","isSuperuser","NATURE_SUMMARY","STATUS_SUMMARY","LOCATION_SUMMARY","KPI_SUMMARY","BarGraph","graphId","meta","title","extra","type","stacked","useEffect","datasets","labels","options","legend","display","window","screen","width","position","plugins","datalabels","hover","mode","intersect","tooltips","displayColors","callbacks","scales","xAxes","gridLines","yAxes","ticks","beginAtZero","callback","value","toLocaleString","userCallback","label","index","Math","floor","Chart","document","getElementById","id","style","ColorsHelper","randomColor","color","i","random","randomColors","num","Array","keys","map","contrastColors","colors","c","invert","ComplaintsByNatureGraph","filter","useLazyQuery","variables","fetchData","abortCtrl","AbortController","abort","natureSummary","natureList","d","name","v","a","indexOf","count","s","backgroundColor","p","x","find","status","r","PieChart","onDataClick","bgColors","formatter","ctx","sum","chart","toFixed","onClick","_","els","slice","_index","myPieChart","ComplaintsByStatusGraph","statusSummary","ComplaintsByLocationGraph","locationSummary","locName","locCount","ComplaintsKPIGraph","placeHolder","kpiSummary","natureName","nat","Input","help","cls","htmlFor","Select","query","skip","o","key","FilterExport","fields","handleChange","handleSubmit","handleExport","filterLabel","onSubmit","f","onChange","Dates","date","timeIncl","Date","month","getMonth","day","getDate","year","getFullYear","hour","getHours","minutes","getMinutes","dateStr","join","timeStr","res","FilterForm","useState","formData","setFormData","startDate","setDate","searchFields","defaultValue","now","e","preventDefault","target","HomePage","Map","setFilter","Table","columns","idCol","col","row","render","MatIcon","text","COMPLAINTS","GET_COMPLAINT","NATURES","COMPLAINT_ATTACHMENTS","LOCATIONS","REGISTER_COMPLAINT","UPDATE_ASSIGN_COMPLAINT","UPDATE_DETAILS_COMPLAINT","SEND_FEEDBACK","GET_STATUSES","attachmentsChangeHandler","cb","files","theFiles","reader","FileReader","file","addEventListener","result","filename","updateAttachements","readAsDataURL","COMPLAINTS_FILTER_VARS","pageSize","pageNo","NewComplaintRegisterPage","natures","locations","redirect","setRedirect","useMutation","registerComplaint","natureOptions","locationOptions","attachments","setAttachments","openDate","refetchQueries","awaitRefetchQueries","then","required","max","toISOString","split","maxLength","multiple","Modal","onClose","children","posx","posy","ReactDom","createPortal","AssignComplaintPopup","complaint","onComplete","users","assignTo","userOptions","withRouter","match","params","updateDetails","inputsConf","prev","Object","forEach","details","actionPlan","rca","results","rows","financialImpact","costCenter","responsiblePerson","Pagination","onPageChanged","lastPage","disabled","FeedbackForm","sendFeedback","email","setEmail","remarks","setRemarks","encType","CONF","DEV","baseUrl","ROOT","PROD","BASE_URL","ROOT_URL","Attachment","doc","href","download","ComplaintAttachements","complaint_id","complaintAttachments","dayjs","require","html2canvas","detailsView","useRef","feedback","setFeedback","img","setImg","open","close","clientName","location","nature","closeDate","assignedTo","assignedAt","closedBy","fmtDate","strDate","format","ref","diff","btn","current","scrollY","canvas","dt","toDataURL","ComplaintsPage","setPageNo","getComplaints","assign","setAssign","selected","setSelected","parsed","parse","toLocaleDateString","records","complaints","nature_name","location_name","path","entries","q","fetch","response","blob","url","URL","createObjectURL","createElement","body","appendChild","click","remove","newPageNo","NewUserPage","registerUser","readOnly","firstName","lastName","UserManagementPage","AuthHelper","saveToken","token","sessionStorage","setItem","getToken","getItem","removeToken","removeItem","LoginPage","login","client","src","alt","clearStore","tokenAuth","ChangePasswordForm","fail","setFail","changePassword","formEl","reset","UserProfilePage","formOpen","setFormOpen","accept","ApolloClient","uri","request","operation","setContext","headers","Authorization","App","Boolean","hostname","ReactDOM","StrictMode","navigator","serviceWorker","ready","registration","unregister","catch"],"mappings":"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","file":"static/js/main.cb47dc55.chunk.js","sourcesContent":["import { gql } from \"apollo-boost\";\r\nexport const USERS_GET_TOKEN = gql`\r\n  mutation getToken($username: String!, $password: String!) {\r\n    tokenAuth(username: $username, password: $password) {\r\n      token\r\n    }\r\n  }\r\n`;\r\n\r\nexport const USERS_GET_ME = gql`\r\n  query getMe {\r\n    me {\r\n      id\r\n      username\r\n      dateJoined\r\n      firstName\r\n      lastName\r\n      lastLogin\r\n      email\r\n      isStaff\r\n      isSuperuser\r\n    }\r\n  }\r\n`;\r\n\r\nexport const USERS = gql`\r\n  query getUsers {\r\n    users {\r\n      id\r\n      username\r\n      dateJoined\r\n      firstName\r\n      lastName\r\n      lastLogin\r\n      email\r\n      isStaff\r\n      isSuperuser\r\n    }\r\n  }\r\n`;\r\n\r\nexport const REGISTER_USER = gql`\r\n  mutation registerUser(\r\n    $id: ID\r\n    $username: String!\r\n    $email: String!\r\n    $firstName: String\r\n    $lastName: String\r\n  ) {\r\n    registerUser(\r\n      id: $id\r\n      username: $username\r\n      email: $email\r\n      firstName: $firstName\r\n      lastName: $lastName\r\n    ) {\r\n      user {\r\n        id\r\n        username\r\n        dateJoined\r\n        firstName\r\n        lastName\r\n        lastLogin\r\n        email\r\n        isStaff\r\n        isSuperuser\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nexport const GET_USER = gql`\r\n  query getUser($id: ID!) {\r\n    user(id: $id) {\r\n      id\r\n      username\r\n      dateJoined\r\n      firstName\r\n      lastName\r\n      lastLogin\r\n      email\r\n      isStaff\r\n      isSuperuser\r\n    }\r\n  }\r\n`;\r\n\r\nexport const CHANGE_PASSWORD = gql`\r\n  mutation changePassword(\r\n    $password: String!\r\n    $newPassword: String!\r\n  ) {\r\n    changePassword(\r\n      password: $password\r\n      newPassword: $newPassword\r\n    ) {\r\n      user {\r\n        id\r\n        username\r\n        dateJoined\r\n        firstName\r\n        lastName\r\n        lastLogin\r\n        email\r\n        isStaff\r\n        isSuperuser\r\n      }\r\n    }\r\n  }\r\n`;\r\n","import React from \"react\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport { useQuery } from \"@apollo/react-hooks\";\r\nimport { USERS_GET_ME } from \"../../helpers/UsersGraphQL\";\r\n\r\nfunction UserProfile(props) {\r\n  let { loading, error, data } = useQuery(USERS_GET_ME);\r\n  if (loading) return <p>Loading...</p>;\r\n  if (error) return <p>Error :(</p>;\r\n  console.log(data);\r\n  return (\r\n    <div className=\"user-profile-nav\">\r\n      <ul>\r\n        <li>\r\n          <NavLink exact to=\"/my-profile\">{data.me.username}</NavLink>\r\n        </li>\r\n        <li>\r\n          <NavLink exact to=\"/login\">\r\n            Logout\r\n          </NavLink>\r\n        </li>\r\n      </ul>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default UserProfile;\r\n","import React from \"react\";\r\nimport { useQuery } from \"@apollo/react-hooks\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport { USERS_GET_ME } from \"../../helpers/UsersGraphQL\";\r\n\r\nfunction useProfile() {\r\n  const history = useHistory();\r\n  const { loading, error, data } = useQuery(USERS_GET_ME);\r\n  if (loading) return null;\r\n  if (error) {\r\n    if (error.graphQLErrors.length) {\r\n      let message = error.graphQLErrors[0].message;\r\n      if (\r\n        message === \"Signature has expired\" ||\r\n        message === \"You do not have permission to perform this action\"\r\n      ) {\r\n        history.push(\"/login\");\r\n      }\r\n    }\r\n    console.log(error);\r\n    return null;\r\n  }\r\n  return data;\r\n}\r\n\r\nexport default useProfile;\r\n","import React from \"react\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport UserProfile from \"./UserProfile\";\r\nimport useProfile from \"../hooks/useProfile\";\r\n\r\nfunction NavBar() {\r\n  const user = useProfile();\r\n  console.log(user);\r\n  return (\r\n    <header className=\"navbar container\">\r\n      <div className=\"content\">\r\n        <h3>Twiga - CCMS</h3>\r\n        <div className=\"nav-links\">\r\n          <ul>\r\n            <li>\r\n              <NavLink exact to=\"/\">\r\n                Home\r\n              </NavLink>\r\n            </li>\r\n            <li>\r\n              <NavLink to=\"/complaints\">Complaints</NavLink>\r\n            </li>\r\n            {user && user.me && user.me.isSuperuser && (\r\n              <li>\r\n                <NavLink to=\"/users\">Users</NavLink>\r\n              </li>\r\n            )}\r\n          </ul>\r\n          <UserProfile />\r\n        </div>\r\n      </div>\r\n    </header>\r\n  );\r\n}\r\n\r\nexport default NavBar;\r\n","import { gql } from \"apollo-boost\";\r\n\r\nexport const NATURE_SUMMARY = gql`\r\n  query natureSummary(\r\n    $dateFrom: Date\r\n    $dateTo: Date\r\n    ) {\r\n    natureSummary(\r\n      dateFrom: $dateFrom\r\n      dateTo: $dateTo\r\n      ) {\r\n      name\r\n      status\r\n      count\r\n    }\r\n  }\r\n`;\r\n\r\nexport const STATUS_SUMMARY = gql`\r\n  query statusSummary(\r\n    $dateFrom: Date\r\n    $dateTo: Date\r\n    ) {\r\n    statusSummary(\r\n      dateFrom: $dateFrom\r\n      dateTo: $dateTo\r\n      ) {\r\n      name\r\n      count\r\n    }\r\n  }\r\n`;\r\n\r\nexport const LOCATION_SUMMARY = gql`\r\n  query getLocSummary(\r\n    $dateFrom: Date\r\n    $dateTo: Date\r\n    ) {\r\n    locationSummary(\r\n      dateFrom: $dateFrom\r\n      dateTo: $dateTo\r\n      ) {\r\n      locName\r\n      locCount\r\n    }\r\n  }\r\n`;\r\n\r\nexport const KPI_SUMMARY = gql`\r\n  query kpi(\r\n    $dateFrom: Date\r\n    $dateTo: Date\r\n    ) {\r\n    kpiSummary(\r\n      dateFrom: $dateFrom\r\n      dateTo: $dateTo\r\n      ) {\r\n      name\r\n      count\r\n      natureName\r\n    }\r\n  }\r\n`;\r\n","import React from \"react\";\r\nimport Chart from \"chart.js\";\r\nimport Numbers from \"../../helpers/Numbers\";\r\nimport { useEffect } from \"react\";\r\n\r\nconst BarGraph = ({\r\n  graphId,\r\n  meta,\r\n  title,\r\n  extra = null,\r\n  type = \"bar\",\r\n  stacked = false,\r\n}) => {\r\n  useEffect(() => {\r\n    const data = {\r\n      datasets: meta.data,\r\n      labels: meta.labels,\r\n    };\r\n    console.log(data);\r\n    const options = {\r\n      legend: {\r\n        display: window.screen.width > 800,\r\n        position: \"top\",\r\n      },\r\n      plugins: {\r\n        datalabels: {\r\n          display: false,\r\n        },\r\n      },\r\n      hover: {\r\n        mode: \"index\",\r\n        intersect: false,\r\n      },\r\n      tooltips: {\r\n        displayColors: true,\r\n        callbacks: {\r\n          mode: \"x\",\r\n        },\r\n      },\r\n      scales: {\r\n        xAxes: [\r\n          {\r\n            stacked: stacked,\r\n            gridLines: {\r\n              display: false,\r\n            },\r\n          },\r\n        ],\r\n        yAxes: [\r\n          {\r\n            stacked: stacked,\r\n            ticks: {\r\n              beginAtZero: meta.beginAtZero || false,\r\n              callback: function (value) {\r\n                return value.toLocaleString();\r\n              },\r\n              userCallback: function (label, index, labels) {\r\n                if (Math.floor(label) === label) {\r\n                  return label;\r\n                }\r\n              },\r\n            },\r\n            type: \"linear\",\r\n          },\r\n        ],\r\n      },\r\n    };\r\n\r\n    new Chart(document.getElementById(graphId), {\r\n      type: type,\r\n      data: data,\r\n      options: options,\r\n    });\r\n  }, []);\r\n\r\n  return (\r\n    <div className={`graph-container bg-white card ${extra ? extra : \"\"}`}>\r\n      <h6 className=\"pl-1\">{title}</h6>\r\n      <div>\r\n        <canvas id={graphId} className=\"graph p-1\" style={{}}></canvas>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default BarGraph;\r\n","import invert from \"invert-color\";\r\nexport const ColorsHelper = {\r\n  randomColor() {\r\n    var letters = \"0123456789ABCDEF\";\r\n    var color = \"#\";\r\n    for (var i = 0; i < 6; i++) {\r\n      color += letters[Math.floor(Math.random() * 16)];\r\n    }\r\n    return color;\r\n  },\r\n  randomColors(num) {\r\n    return [...Array(num).keys()].map(() => this.randomColor());\r\n  },\r\n  contrastColors(colors) {\r\n    return colors.map(c => invert(c));\r\n  }\r\n};\r\n","import React, { useEffect } from \"react\";\r\nimport { NATURE_SUMMARY } from \"../../helpers/ReportsGraphQL\";\r\nimport { useLazyQuery, useQuery } from \"@apollo/react-hooks\";\r\nimport BarGraph from \"../../components/graph/BarGraph\";\r\nimport ChartDataLabels from \"chartjs-plugin-datalabels\";\r\nimport useProfile from \"../../components/hooks/useProfile\";\r\nimport { ColorsHelper } from \"../../helpers/ColorsHelper\";\r\n\r\nfunction ComplaintsByNatureGraph({ filter }) {\r\n  useProfile();\r\n\r\n  const [fetchData, { loading, data, error }] = useLazyQuery(NATURE_SUMMARY, {\r\n    variables: { ...filter },\r\n  });\r\n\r\n  useEffect(() => {\r\n    const abortCtrl = new AbortController();\r\n    console.log(filter)\r\n    fetchData()\r\n    return () => {\r\n      abortCtrl.abort();\r\n    }\r\n  }, [filter])\r\n\r\n  if (loading) return null;\r\n  if (error) return null;\r\n  if (!data) return null;\r\n  console.log(data);\r\n\r\n  let placeHolder = [\r\n    { name: \"Not Assigned\", count: 0 },\r\n    { name: \"Assigned\", count: 0 },\r\n    { name: \"Completed\", count: 0 },\r\n    { name: \"Feedback Sent\", count: 0 },\r\n  ];\r\n  console.log(data.natureSummary);\r\n\r\n  let natureList = data.natureSummary\r\n    .map((d) => {\r\n      return d.name;\r\n    })\r\n    .filter((v, i, a) => a.indexOf(v) === i);\r\n  let res = placeHolder.map((s) => {\r\n    return {\r\n      label: s.name,\r\n      backgroundColor: ColorsHelper.randomColor(),\r\n      data: natureList.map((p) => {\r\n        let x = data.natureSummary.find(\r\n          (d) => d.name === p && d.status === s.name\r\n        );\r\n        return x ? x.count : 0;\r\n      }),\r\n    };\r\n  });\r\n\r\n  const meta = {\r\n    data: res,\r\n    labels: natureList.map((r) => r),\r\n    beginAtZero: true,\r\n  };\r\n  return (\r\n    <BarGraph\r\n      stacked={true}\r\n      meta={meta}\r\n      title=\"Complaints Nature Summary\"\r\n      graphId=\"complaints-nature-summary\"\r\n    />\r\n  );\r\n}\r\n\r\nexport default ComplaintsByNatureGraph;\r\n","import React from \"react\";\r\nimport { ColorsHelper } from \"../../helpers/ColorsHelper\";\r\nimport Chart from \"chart.js\";\r\nimport { useEffect } from \"react\";\r\nimport ChartDataLabels from \"chartjs-plugin-datalabels\";\r\n\r\nconst PieChart = ({ meta, graphId, title, colors, onDataClick }) => {\r\n  useEffect(() => {\r\n    let bgColors = colors || ColorsHelper.randomColors(meta.data.length);\r\n    let fntColors = ColorsHelper.contrastColors(bgColors);\r\n    let options = {\r\n      legend: {\r\n        position: \"right\",\r\n      },\r\n      plugins: {\r\n        datalabels: {\r\n          formatter: (value, ctx) => {\r\n            let sum = 0;\r\n            let dataArr = ctx.chart.data.datasets[0].data;\r\n            dataArr.map((data) => {\r\n              sum += data;\r\n            });\r\n            let percentage = ((value * 100) / sum).toFixed(0) + \"%\";\r\n            return percentage;\r\n          },\r\n          color: fntColors,\r\n        },\r\n      },\r\n      onClick: (_, els) => {\r\n        if (els && els.length && onDataClick) {\r\n          let data = meta.data.slice(els[0]._index, els[0]._index + 1)[0];\r\n          onDataClick(data);\r\n        }\r\n      },\r\n    };\r\n    let data = {\r\n      datasets: [\r\n        {\r\n          data: meta.data.map((d) => d.value),\r\n          backgroundColor: bgColors,\r\n        },\r\n      ],\r\n      labels: meta.data.map((d) => d.name),\r\n    };\r\n\r\n    var myPieChart = new Chart(document.getElementById(graphId), {\r\n      type: \"pie\",\r\n      data: data,\r\n      options: options,\r\n    });\r\n    console.log(myPieChart);\r\n  }, []);\r\n  return (\r\n    <div className=\"graph-container bg-white card p-2\">\r\n      <h6 className=\"pl-1\">{title}</h6>\r\n      <div>\r\n        <canvas id={graphId} className=\"graph p-1\" style={{}}></canvas>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default PieChart;\r\n","import React, { useEffect } from \"react\";\r\nimport { STATUS_SUMMARY } from \"../../helpers/ReportsGraphQL\";\r\nimport { useLazyQuery } from \"@apollo/react-hooks\";\r\nimport PieChart from \"../../components/graph/PieChart\";\r\nimport useProfile from \"../../components/hooks/useProfile\";\r\n\r\nfunction ComplaintsByStatusGraph({ filter }) {\r\n  useProfile();\r\n  const [fetchData, { loading, data, error }] = useLazyQuery(STATUS_SUMMARY, {\r\n    variables: { ...filter },\r\n  });\r\n\r\n\r\n  useEffect(() => {\r\n    const abortCtrl = new AbortController();\r\n    console.log(filter)\r\n    fetchData()\r\n    return () => {\r\n      abortCtrl.abort();\r\n    }\r\n  }, [filter])\r\n\r\n  if (loading) return null;\r\n  if (error) return null;\r\n  if (!data) return null;\r\n  console.log(data);\r\n\r\n  const meta = {\r\n    data: data.statusSummary.map((r) => {\r\n      return {\r\n        name: r.name,\r\n        value: r.count,\r\n      };\r\n    }),\r\n  };\r\n  return (\r\n    <PieChart\r\n      meta={meta}\r\n      title=\"Complaints Status Summary\"\r\n      graphId=\"complaints-status-summary\"\r\n    />\r\n  );\r\n}\r\n\r\nexport default ComplaintsByStatusGraph;\r\n","import React, { useEffect } from \"react\";\r\nimport { LOCATION_SUMMARY } from \"../../helpers/ReportsGraphQL\";\r\nimport { useLazyQuery } from \"@apollo/react-hooks\";\r\nimport PieChart from \"../../components/graph/PieChart\";\r\nimport useProfile from \"../../components/hooks/useProfile\";\r\n\r\nfunction ComplaintsByLocationGraph({ filter }) {\r\n  useProfile();\r\n\r\n  const [fetchData, { loading, data, error }] = useLazyQuery(LOCATION_SUMMARY, {\r\n    variables: { ...filter },\r\n  });\r\n\r\n  useEffect(() => {\r\n    const abortCtrl = new AbortController();\r\n    console.log(filter)\r\n    fetchData()\r\n    return () => {\r\n      abortCtrl.abort();\r\n    }\r\n  }, [filter])\r\n\r\n  if (loading) return null;\r\n  if (error) return null;\r\n  if (!data) return null;\r\n  console.log(data);\r\n\r\n  const meta = {\r\n    data: data.locationSummary.map((r) => {\r\n      return {\r\n        name: r.locName,\r\n        value: r.locCount,\r\n      };\r\n    }),\r\n  };\r\n  return (\r\n    <PieChart\r\n      meta={meta}\r\n      title=\"Complaints Location Summary\"\r\n      graphId=\"complaints-location-summary\"\r\n    />\r\n  );\r\n}\r\n\r\nexport default ComplaintsByLocationGraph;\r\n","import React, { useEffect } from \"react\";\r\nimport { KPI_SUMMARY } from \"../../helpers/ReportsGraphQL\";\r\nimport { useLazyQuery } from \"@apollo/react-hooks\";\r\nimport useProfile from \"../../components/hooks/useProfile\";\r\nimport BarGraph from \"../../components/graph/BarGraph\";\r\nimport { ColorsHelper } from \"../../helpers/ColorsHelper\";\r\n\r\nfunction ComplaintsKPIGraph({ filter }) {\r\n  useProfile();\r\n\r\n  const [fetchData, { loading, data, error }] = useLazyQuery(KPI_SUMMARY, {\r\n    variables: { ...filter },\r\n  });\r\n\r\n  useEffect(() => {\r\n    const abortCtrl = new AbortController();\r\n    console.log(filter)\r\n    fetchData()\r\n    return () => {\r\n      abortCtrl.abort();\r\n    }\r\n  }, [filter])\r\n\r\n  if (loading) return null;\r\n  if (error) return null;\r\n  if (!data) return null;\r\n  console.log(data);\r\n\r\n  let placeHolder = [\r\n    { name: \"1 week\", count: 0 },\r\n    { name: \"2 weeks\", count: 0 },\r\n    { name: \"3-4 weeks\", count: 0 },\r\n    { name: \"5-6 weeks\", count: 0 },\r\n    { name: \"7-8 weeks\", count: 0 },\r\n    { name: \"Above 8 weeks\", count: 0 },\r\n  ];\r\n  console.log(data.kpiSummary);\r\n\r\n  let natureList = data.kpiSummary\r\n    .map((d) => d.natureName)\r\n    .filter((v, i, a) => a.indexOf(v) === i);\r\n  let res = natureList.map((nat) => {\r\n    return {\r\n      label: nat,\r\n      backgroundColor: ColorsHelper.randomColor(),\r\n      data: placeHolder.map((p) => {\r\n        let x = data.kpiSummary.find(\r\n          (d) => d.natureName === nat && d.name === p.name\r\n        );\r\n        return x ? x.count : 0;\r\n      }),\r\n    };\r\n  });\r\n\r\n  const meta = {\r\n    data: res,\r\n    labels: placeHolder.map((r) => r.name),\r\n    beginAtZero: true,\r\n  };\r\n\r\n  return (\r\n    <BarGraph\r\n      stacked={true}\r\n      meta={meta}\r\n      title=\"Complaints KPI\"\r\n      graphId=\"complaints-kpi-summary\"\r\n    />\r\n  );\r\n}\r\n\r\nexport default ComplaintsKPIGraph;\r\n","import React from \"react\";\r\n\r\nfunction Input({ label, name, help, type = \"text\", cls, ...props }) {\r\n  return (\r\n    <div className={`input-wrap ${cls || \"\"}`}>\r\n      <label htmlFor={name}>{label}</label>\r\n      {type === \"textarea\" ? (\r\n        <textarea name={name} id={name} {...props} />\r\n      ) : (\r\n        <input type={type} name={name} id={name} {...props} />\r\n      )}\r\n      {help && <span className=\"input-help\">{help}</span>}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Input;\r\n","import React from \"react\";\r\nimport { useQuery } from \"@apollo/react-hooks\";\r\nimport { USERS_GET_ME } from \"../../helpers/UsersGraphQL\";\r\n\r\nfunction Select({ label, name, query, options = [], ...props }) {\r\n  let { loading, data, error } = useQuery(query ? query.name : USERS_GET_ME, {\r\n    skip: query === null,\r\n  });\r\n  if (loading || error) {\r\n    return null;\r\n  }\r\n\r\n  if (data && query) {\r\n    options = data[query.data];\r\n  }\r\n\r\n  return (\r\n    <div className=\"input-wrap\">\r\n      <label htmlFor={name}>{label}</label>\r\n      <select name={name} id={name} {...props}>\r\n        <option value=\"\">---Select---</option>\r\n        {options.map((o) => (\r\n          <option key={o.id} value={o.id}>\r\n            {o.name}\r\n          </option>\r\n        ))}\r\n      </select>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Select;\r\n","import React from \"react\";\r\nimport Input from \"./Input\";\r\nimport Select from \"./Select\";\r\n\r\nfunction FilterExport({\r\n  fields,\r\n  handleChange,\r\n  handleSubmit,\r\n  filter,\r\n  handleExport,\r\n  filterLabel\r\n}) {\r\n  return (\r\n    <div className=\"filter-export  w-100\">\r\n      <form className=\"form d-flex align-bottom\" onSubmit={handleSubmit}>\r\n        <div className=\"inline-fields\">\r\n          {fields.map((f, i) => {\r\n            return f.type && f.type === \"select\" ? (\r\n              <>\r\n                <Select key={f.name} {...f} onChange={handleChange} />\r\n              </>\r\n            ) : <>\r\n                <Input key={f.name} {...f} onChange={handleChange} />\r\n              </>;\r\n          })}\r\n        </div>\r\n        <div className=\"d-flex\">\r\n          <button name=\"filter\">{filterLabel || 'Filter'}</button>\r\n          {handleExport && <button\r\n            className=\"ml-1\"\r\n            name=\"export\"\r\n            type=\"button\"\r\n            onClick={handleExport}\r\n          >\r\n            Export\r\n          </button>}\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default FilterExport;\r\n","export const Dates = {\r\n  fmt: function formatDate(date, timeIncl = false) {\r\n    var d = new Date(date),\r\n      month = \"\" + (d.getMonth() + 1),\r\n      day = \"\" + d.getDate(),\r\n      year = d.getFullYear(),\r\n      hour = d.getHours(),\r\n      minutes = d.getMinutes();\r\n\r\n    if (month.length < 2) month = \"0\" + month;\r\n    if (day.length < 2) day = \"0\" + day;\r\n    if (hour < 10) hour = \"0\" + hour;\r\n    if (minutes < 10) minutes = \"0\" + minutes;\r\n\r\n    let dateStr = [year, month, day].join(\"-\")\r\n    let timeStr = `${hour}:${minutes < 10 ? \"0\" + minutes : minutes}:00.00`\r\n    let res = timeIncl ? dateStr + \"T\" + timeStr : dateStr;\r\n    return res\r\n  },\r\n};\r\n","import React, { useState } from \"react\";\r\nimport FilterExport from \"../../components/forms/FilterExport\";\r\nimport { Dates } from \"../../helpers/Dates\";\r\n\r\nfunction FilterForm({ handleSubmit, handleExport, filter = {} }) {\r\n  console.log(filter);\r\n  const [formData, setFormData] = useState(filter);\r\n  const startDate = new Date()\r\n  startDate.setDate(startDate.getDate() - 30)\r\n  const searchFields = [\r\n    {\r\n      name: \"dateFrom\",\r\n      label: \"From\",\r\n      type: \"date\",\r\n      defaultValue: filter[\"dateFrom\"] || Dates.fmt(startDate),\r\n    },\r\n    {\r\n      name: \"dateTo\",\r\n      label: \"To\",\r\n      type: \"date\",\r\n      defaultValue: filter[\"dateTo\"] || Dates.fmt(Date.now()),\r\n    },\r\n  ];\r\n  function handleChange(e) {\r\n    const { value, name } = e.target;\r\n    setFormData({ ...formData, [name]: value || null });\r\n  }\r\n\r\n  return (\r\n    <FilterExport\r\n      handleSubmit={(e) => {\r\n        e.preventDefault();\r\n        handleSubmit(formData);\r\n      }}\r\n      fields={searchFields}\r\n      handleChange={handleChange}\r\n      filterLabel='Refresh'\r\n    />\r\n  );\r\n}\r\n\r\nexport default FilterForm;\r\n","import React, { useEffect, useState } from \"react\";\r\nimport ComplaintsByNatureGraph from \"./dashboard/ComplaintsByNatureGraph\";\r\nimport ComplaintsByStatusGraph from \"./dashboard/ComplaintsByStatusGraph\";\r\nimport ComplaintsByLocationGraph from \"./dashboard/ComplaintsByLocationGraph\";\r\nimport ComplaintsKPIGraph from \"./dashboard/ComplaintsKPIGraph\";\r\nimport FilterForm from \"./dashboard/FilterForm\";\r\n\r\n\r\nfunction HomePage() {\r\n  const [filter, setFilter] = useState(new Map());\r\n  const handleSubmit = (formData) => {\r\n    setFilter({ ...formData })\r\n  }\r\n\r\n  return (\r\n    <div className=\"dashboard-container\">\r\n      <div className=\"toolbar\">\r\n        {(\r\n          <FilterForm\r\n            handleSubmit={handleSubmit}\r\n            filter={filter} />\r\n        )}\r\n      </div>\r\n      <div className=\"dashboard\">\r\n        <ComplaintsByStatusGraph filter={filter} />\r\n        <ComplaintsByLocationGraph filter={filter} />\r\n        <ComplaintsByNatureGraph filter={filter} />\r\n        <ComplaintsKPIGraph filter={filter} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default HomePage;\r\n","import React from \"react\";\r\n\r\nfunction Table({ columns, data, idCol = \"id\" }) {\r\n  return (\r\n    <div className=\"table-container\">\r\n      <table className=\"table-scrollable\">\r\n        <thead>\r\n          <tr>\r\n            {columns.map((col) => (\r\n              <th key={col.name}>{col.label}</th>\r\n            ))}\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {data.map((row) => (\r\n            <tr key={row[idCol]}>\r\n              {columns.map((col) => (\r\n                <td key={col.name} className={col.className}>\r\n                  {col.render ? col.render(row) : row[col.name]}\r\n                </td>\r\n              ))}\r\n            </tr>\r\n          ))}\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Table;\r\n","import React from \"react\";\r\nconst MatIcon = ({ name, extra, text }) => (\r\n  <>\r\n    <span className={`mat-icon material-icons${extra ? \" \" + extra : \"\"}`}>\r\n      {name}\r\n    </span>\r\n    {text && <span>{text}</span>}\r\n  </>\r\n);\r\nexport default MatIcon;\r\n","import { gql } from \"apollo-boost\";\r\n\r\nexport const COMPLAINTS = gql`\r\n  query fetchComplaints(\r\n    $pageNo: Int\r\n    $pageSize: Int\r\n    $clientName: String\r\n    $location: Int\r\n    $nature: Int\r\n    $status: String\r\n    $dateFrom: Date\r\n    $dateTo: Date\r\n  ) {\r\n    complaints(\r\n      pageNo: $pageNo\r\n      pageSize: $pageSize\r\n      clientName: $clientName\r\n      location: $location\r\n      nature: $nature\r\n      status: $status\r\n      dateFrom: $dateFrom\r\n      dateTo: $dateTo\r\n    ) {\r\n      id\r\n      clientName\r\n      location {\r\n        id\r\n        name\r\n      }\r\n      openDate\r\n      status\r\n      details\r\n      rca\r\n      actionPlan\r\n      results\r\n      financialImpact\r\n      costCenter\r\n      responsiblePerson\r\n      dueDate\r\n      closeDate\r\n      assignedTo {\r\n        id\r\n        username\r\n      }\r\n      nature {\r\n        id\r\n        name\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nexport const GET_COMPLAINT = gql`\r\n  query getComplaint($id: ID!) {\r\n    complaint(id: $id) {\r\n      id\r\n      clientName\r\n      openDate\r\n      status\r\n      details\r\n      rca\r\n      actionPlan\r\n      results\r\n      financialImpact\r\n      costCenter\r\n      responsiblePerson\r\n      dueDate\r\n      nature {\r\n        id\r\n        name\r\n      }\r\n      location {\r\n        id\r\n        name\r\n      }\r\n      assignedTo {\r\n        id\r\n        username\r\n      }\r\n      assignedAt\r\n      closedBy {\r\n        id\r\n        username\r\n      }\r\n      closeDate\r\n    }\r\n  }\r\n`;\r\n\r\nexport const NATURES = gql`\r\n  query getNatures {\r\n    natures {\r\n      id\r\n      name\r\n    }\r\n  }\r\n`;\r\nexport const COMPLAINT_ATTACHMENTS = gql`\r\n  query getComplAttachments($complaint_id: ID!) {\r\n    complaintAttachments(complaintId: $complaint_id) {\r\n      id\r\n      file\r\n    }\r\n  }\r\n`;\r\nexport const LOCATIONS = gql`\r\n  query getLocations {\r\n    locations {\r\n      id\r\n      name\r\n    }\r\n  }\r\n`;\r\n\r\nexport const REGISTER_COMPLAINT = gql`\r\n  mutation createComplaint(\r\n    $details: String!\r\n    $clientName: String!\r\n    $openDate: DateTime!\r\n    $nature: ID!\r\n    $location: ID!\r\n    $attachments: [FileType]\r\n  ) {\r\n    registerComplaint(\r\n      details: $details\r\n      clientName: $clientName\r\n      nature: $nature\r\n      location: $location\r\n      openDate: $openDate\r\n      attachments: $attachments\r\n    ) {\r\n      complaint {\r\n        id\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nexport const UPDATE_ASSIGN_COMPLAINT = gql`\r\n  mutation assignTo($id: ID!, $userId: ID!) {\r\n    assignComplaint(id: $id, userId: $userId) {\r\n      complaint {\r\n        id\r\n        details\r\n        assignedTo {\r\n          id\r\n          username\r\n        }\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nexport const UPDATE_DETAILS_COMPLAINT = gql`\r\n  mutation updateDetails(\r\n    $id: ID!\r\n    $rca: String!\r\n    $actionPlan: String!\r\n    $results: String!\r\n    $financialImpact: String!\r\n    $costCenter: String!\r\n    $responsiblePerson: String!\r\n    $attachments: [FileType]\r\n  ) {\r\n    updateComplaint(\r\n      id: $id\r\n      rca: $rca\r\n      actionPlan: $actionPlan\r\n      results: $results\r\n      financialImpact: $financialImpact\r\n      costCenter: $costCenter\r\n      responsiblePerson: $responsiblePerson\r\n      attachments: $attachments\r\n    ) {\r\n      complaint {\r\n        id\r\n        details\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nexport const SEND_FEEDBACK = gql`\r\n  mutation sendFeedback(\r\n    $attachments: [FileType]\r\n    $id: ID!\r\n    $email: String!\r\n    $remarks: String\r\n  ) {\r\n    feedback(\r\n      attachments: $attachments\r\n      id: $id\r\n      email: $email\r\n      remarks: $remarks\r\n    ) {\r\n      complaint {\r\n        id\r\n        clientName\r\n      }\r\n    }\r\n  }\r\n`;\r\n\r\nexport const GET_STATUSES = gql`\r\n  query getStatuses {\r\n    statuses {\r\n      id\r\n      name\r\n    }\r\n  }\r\n`;\r\n","export const attachmentsChangeHandler = (e, cb) => {\r\n  let files = [];\r\n\r\n  let updateAttachements = (files) => {\r\n    cb(files);\r\n  };\r\n\r\n  let theFiles = e.target.files;\r\n  for (let i = 0; i < theFiles.length; i++) {\r\n    const reader = new FileReader();\r\n    let file = theFiles[i];\r\n    reader.addEventListener(\"load\", () => {\r\n      let data = reader.result;\r\n      files.push({ filename: file.name, data: data });\r\n      if (files.length === theFiles.length) {\r\n        updateAttachements(files);\r\n      }\r\n    });\r\n    reader.readAsDataURL(file);\r\n  }\r\n};\r\n","export const PAGE_SIZE = 10;\r\n\r\nexport const COMPLAINTS_FILTER_VARS = {\r\n  pageSize: PAGE_SIZE,\r\n  pageNo: 1,\r\n};\r\n","import React, { useState } from \"react\";\r\nimport Input from \"../../components/forms/Input\";\r\nimport Select from \"../../components/forms/Select\";\r\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\r\nimport {\r\n  REGISTER_COMPLAINT,\r\n  COMPLAINTS,\r\n  NATURES,\r\n  LOCATIONS,\r\n} from \"../../helpers/GraphQL\";\r\nimport MatIcon from \"../../components/icons/MatIcon\";\r\nimport { NavLink, Redirect } from \"react-router-dom\";\r\nimport { attachmentsChangeHandler } from \"../../helpers/FileUpload\";\r\nimport { COMPLAINTS_FILTER_VARS } from \"../../constants\";\r\n\r\nfunction NewComplaintRegisterPage({}) {\r\n  let natures = useQuery(NATURES);\r\n  let locations = useQuery(LOCATIONS);\r\n  const [redirect, setRedirect] = useState(null);\r\n  const [formData, setFormData] = useState(new Map());\r\n  const [registerComplaint, { loading }] = useMutation(REGISTER_COMPLAINT);\r\n  const natureOptions = natures.data ? natures.data.natures : [];\r\n  const locationOptions = locations.data ? locations.data.locations : [];\r\n  const [attachments, setAttachments] = useState([]);\r\n  function handleSubmit(e) {\r\n    e.preventDefault();\r\n    registerComplaint({\r\n      variables: {\r\n        ...formData,\r\n        attachments: attachments,\r\n        openDate: `${formData.openDate}T00:00+00:00`,\r\n      },\r\n      refetchQueries: () => [\r\n        { query: COMPLAINTS, variables: COMPLAINTS_FILTER_VARS },\r\n      ],\r\n      awaitRefetchQueries: true,\r\n    }).then(\r\n      () => setRedirect(\"/complaints\"),\r\n      (res) => console.log(\"Error: \", res)\r\n    );\r\n  }\r\n  function handleChange(e) {\r\n    const { value, name } = e.target;\r\n    setFormData({ ...formData, [name]: value });\r\n  }\r\n  return redirect ? (\r\n    <Redirect to={redirect} />\r\n  ) : (\r\n    <div>\r\n      <div className=\"toolbar\">\r\n        <div className=\"titlebar\">\r\n          <NavLink to=\"/complaints\" className=\"btn btn-light mr-1\">\r\n            <MatIcon name=\"keyboard_arrow_left\" />\r\n          </NavLink>\r\n          <h5>Register New Complaint</h5>\r\n        </div>\r\n      </div>\r\n      {loading && <p>Sending ....</p>}\r\n      <form className=\"form\" onSubmit={handleSubmit}>\r\n        <div className=\"form-grid-2\">\r\n          <div>\r\n            <Input\r\n              name=\"clientName\"\r\n              label=\"Client Name\"\r\n              onChange={handleChange}\r\n              required\r\n            />\r\n            <Select\r\n              name=\"location\"\r\n              label=\"Location\"\r\n              options={locationOptions}\r\n              onChange={handleChange}\r\n              required\r\n            />\r\n            <Select\r\n              name=\"nature\"\r\n              label=\"Nature\"\r\n              options={natureOptions}\r\n              onChange={handleChange}\r\n              required\r\n            />\r\n\r\n            <Input\r\n              name=\"openDate\"\r\n              label=\"Open Date\"\r\n              type=\"date\"\r\n              onChange={handleChange}\r\n              required\r\n              max={new Date().toISOString().split(\"T\")[0]}\r\n            />\r\n          </div>\r\n          <div className=\"register-right\">\r\n            <Input\r\n              name=\"details\"\r\n              label=\"Details\"\r\n              type=\"textarea\"\r\n              onChange={handleChange}\r\n              required\r\n              maxLength=\"300\"\r\n              help=\"Max 300 characters\"\r\n              cls=\"large\"\r\n            />\r\n            <Input\r\n              name=\"attachments\"\r\n              type=\"file\"\r\n              label=\"Attachments\"\r\n              multiple\r\n              onChange={(e) =>\r\n                attachmentsChangeHandler(e, (files) => setAttachments(files))\r\n              }\r\n            />\r\n          </div>\r\n        </div>\r\n        <div className=\"form-footer\">\r\n          <button>Submit</button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default NewComplaintRegisterPage;\r\n","import React from \"react\";\r\nimport MatIcon from \"../icons/MatIcon\";\r\nimport ReactDom from \"react-dom\"\r\n\r\n\r\nfunction Modal({ onClose, title, children, posx, posy, ...props }) {\r\n  const showHideClassName = \"modal display-block\";\r\n  return ReactDom.createPortal(\r\n    <div className={showHideClassName} {...props}>\r\n      <div className=\"modal-main\">\r\n        <div className=\"modal-header\">\r\n          {title ? <h5 className=\"modal-title\">{title}</h5> : <span></span>}\r\n          <div className=\"btn-group\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"btn btn-no-bg text-warning m-1 close-button\"\r\n              onClick={onClose}\r\n            >\r\n              <MatIcon name=\"close\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <div className=\"modal-content\">{children}</div>\r\n      </div>\r\n    </div>, document.getElementById(\"portal\")\r\n  );\r\n}\r\n\r\nexport default Modal;\r\n","import React, { useState } from \"react\";\r\nimport Select from \"../../components/forms/Select\";\r\nimport { UPDATE_ASSIGN_COMPLAINT, COMPLAINTS } from \"../../helpers/GraphQL\";\r\nimport { USERS } from \"../../helpers/UsersGraphQL\";\r\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\r\n\r\nfunction AssignComplaintPopup({ complaint, onComplete }) {\r\n  let users = useQuery(USERS);\r\n  const [formData, setFormData] = useState(new Map());\r\n  const [assignTo] = useMutation(UPDATE_ASSIGN_COMPLAINT);\r\n  const userOptions = users.data\r\n    ? users.data.users.map((r) => {\r\n      return { ...r, name: r.username };\r\n    })\r\n    : [];\r\n  console.log(complaint);\r\n  function handleSubmit(e) {\r\n    e.preventDefault();\r\n    assignTo({\r\n      variables: {\r\n        ...formData,\r\n        id: complaint.id,\r\n      },\r\n      refetchQueries: [{ query: COMPLAINTS }],\r\n    }).then(\r\n      () => onComplete(),\r\n      (res) => console.log(\"Error: \", res)\r\n    );\r\n  }\r\n  function handleChange(e) {\r\n    const { value, name } = e.target;\r\n    setFormData({ ...formData, [name]: value });\r\n  }\r\n  return (\r\n    <div>\r\n      <h5>Assign Complaint To User</h5>\r\n      <form className=\"form\" onSubmit={handleSubmit}>\r\n        <div>\r\n          <Select\r\n            name=\"userId\"\r\n            label=\"Assign To\"\r\n            onChange={handleChange}\r\n            required\r\n            options={userOptions}\r\n          />\r\n        </div>\r\n        <div className=\"form-footer\">\r\n          <button>Submit</button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default AssignComplaintPopup;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport {\r\n  COMPLAINTS,\r\n  UPDATE_DETAILS_COMPLAINT,\r\n  GET_COMPLAINT,\r\n} from \"../../helpers/GraphQL\";\r\nimport Input from \"../../components/forms/Input\";\r\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\r\nimport { Redirect, NavLink } from \"react-router-dom\";\r\nimport MatIcon from \"../../components/icons/MatIcon\";\r\nimport { withRouter } from \"react-router\";\r\nimport useProfile from \"../../components/hooks/useProfile\";\r\nimport { attachmentsChangeHandler } from \"../../helpers/FileUpload\";\r\n\r\nfunction UpdateComplaintForm({ match }) {\r\n  useProfile();\r\n  const [redirect, setRedirect] = useState(null);\r\n  const [formData, setFormData] = useState(new Map());\r\n  const [attachments, setAttachments] = useState([]);\r\n\r\n  const { loading, error, data } = useQuery(GET_COMPLAINT, {\r\n    variables: { id: match.params.id },\r\n  });\r\n  const [updateDetails] = useMutation(UPDATE_DETAILS_COMPLAINT);\r\n  if (loading) return <p>Loading...</p>;\r\n  if (error) return <p>Error :(</p>;\r\n  let complaint = data.complaint;\r\n\r\n  function handleSubmit(e) {\r\n    e.preventDefault();\r\n    let prev = new Map();\r\n    Object.keys(complaint).forEach((key) => {\r\n      if (!formData[key]) {\r\n        prev[key] = complaint[key];\r\n      }\r\n    });\r\n\r\n    updateDetails({\r\n      variables: {\r\n        ...formData,\r\n        ...prev,\r\n        attachments: attachments,\r\n        id: complaint.id,\r\n      },\r\n      refetchQueries: [{ query: COMPLAINTS }],\r\n    }).then(\r\n      () => setRedirect(\"/complaints\"),\r\n      (res) => console.log(\"Error: \", res)\r\n    );\r\n  }\r\n  function handleChange(e) {\r\n    const { value, name } = e.target;\r\n    setFormData({ ...formData, [name]: value });\r\n  }\r\n  const inputsConf = {\r\n    type: \"textarea\",\r\n    onChange: handleChange,\r\n    required: \"required\",\r\n    maxLength: \"200\",\r\n    help: \"Max 200 characters\",\r\n  };\r\n  return redirect ? (\r\n    <Redirect to={redirect} />\r\n  ) : (\r\n    <div className=\"form-wrap\">\r\n      <div className=\"toolbar\">\r\n        <div className=\"titlebar\">\r\n          <NavLink to=\"/complaints\" className=\"btn btn-light mr-1\">\r\n            <MatIcon name=\"keyboard_arrow_left\" />\r\n          </NavLink>\r\n          <h5>Fill complain analysis/resolution</h5>\r\n        </div>\r\n      </div>\r\n\r\n      <form className=\"form form-flex v-scroll\" onSubmit={handleSubmit}>\r\n        <div className=\"form-fields\">\r\n          <p>\r\n            <b>Details:</b> {complaint.details}\r\n          </p>\r\n          <Input\r\n            name=\"actionPlan\"\r\n            label=\"Action Plan\"\r\n            {...inputsConf}\r\n            defaultValue={complaint.actionPlan}\r\n          />\r\n          <Input\r\n            name=\"rca\"\r\n            label=\"Root Cause Analysis\"\r\n            {...inputsConf}\r\n            defaultValue={complaint.rca}\r\n          />\r\n          <Input\r\n            name=\"results\"\r\n            label=\"Results\"\r\n            {...inputsConf}\r\n            defaultValue={complaint.results}\r\n            maxLength=\"500\"\r\n            help=\"Max 500 characters\"\r\n            rows=\"4\"\r\n          />\r\n          <Input\r\n            name=\"financialImpact\"\r\n            label=\"Financial Impact\"\r\n            {...inputsConf}\r\n            defaultValue={complaint.financialImpact}\r\n          />\r\n          <Input\r\n            name=\"costCenter\"\r\n            label=\"Cost Center\"\r\n            {...inputsConf}\r\n            defaultValue={complaint.costCenter}\r\n          />\r\n          <Input\r\n            name=\"responsiblePerson\"\r\n            label=\"Responsible Person\"\r\n            {...inputsConf}\r\n            defaultValue={complaint.responsiblePerson}\r\n          />\r\n          <Input\r\n            name=\"attachments\"\r\n            type=\"file\"\r\n            label=\"Attachments\"\r\n            multiple\r\n            onChange={(e) =>\r\n              attachmentsChangeHandler(e, (files) => setAttachments(files))\r\n            }\r\n          />\r\n        </div>\r\n        <div className=\"form-footer\">\r\n          <button>Submit</button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withRouter(UpdateComplaintForm);\r\n","import React from \"react\";\r\nimport MatIcon from \"../icons/MatIcon\";\r\n\r\nfunction Pagination({ pageNo, onPageChanged, lastPage }) {\r\n  const handlePrev = () => {\r\n    let newPage = pageNo > 1 ? pageNo - 1 : 1;\r\n    if (onPageChanged) {\r\n      onPageChanged(newPage);\r\n    }\r\n  };\r\n  const handleNext = () => {\r\n    let newPage = pageNo + 1;\r\n    if (onPageChanged) {\r\n      onPageChanged(newPage);\r\n    }\r\n  };\r\n  return (\r\n    <ul className=\"pagination\">\r\n      <li className=\"btn-wrap\">\r\n        <button onClick={handlePrev} disabled={pageNo <= 1}>\r\n          <MatIcon name=\"keyboard_arrow_left\" /> Previous\r\n        </button>\r\n      </li>\r\n      <li>\r\n        <span>Page {pageNo}</span>\r\n      </li>\r\n      <li className=\"btn-wrap\">\r\n        <button onClick={handleNext} disabled={lastPage}>\r\n          Next <MatIcon name=\"keyboard_arrow_right\" />\r\n        </button>\r\n      </li>\r\n    </ul>\r\n  );\r\n}\r\n\r\nexport default Pagination;\r\n","import React, { useState } from \"react\";\r\nimport { useMutation } from \"@apollo/react-hooks\";\r\nimport { SEND_FEEDBACK, COMPLAINTS } from \"../../helpers/GraphQL\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport Input from \"../../components/forms/Input\";\r\nimport { attachmentsChangeHandler } from \"../../helpers/FileUpload\";\r\n\r\nfunction FeedbackForm({ complaint }) {\r\n  const [sendFeedback] = useMutation(SEND_FEEDBACK);\r\n  const [redirect, setRedirect] = useState(null);\r\n  const [email, setEmail] = useState(null);\r\n  const [remarks, setRemarks] = useState(null);\r\n  const [attachments, setAttachments] = useState([]);\r\n\r\n  function sendNow(e) {\r\n    e.preventDefault();\r\n    let params = {\r\n      id: complaint.id,\r\n      attachments: attachments,\r\n      email: email,\r\n      remarks: remarks,\r\n    };\r\n    console.log(params);\r\n    sendFeedback({\r\n      variables: params,\r\n      refetchQueries: [{ query: COMPLAINTS }],\r\n    }).then(\r\n      () => setRedirect(\"/complaints\"),\r\n      (res) => console.log(\"Error: \", res)\r\n    );\r\n  }\r\n\r\n  return redirect ? (\r\n    <Redirect to={redirect} />\r\n  ) : (\r\n      <div>\r\n        <form className=\"form\" onSubmit={sendNow} encType=\"multipart/form-data\">\r\n          <div>\r\n            <Input\r\n              name=\"email\"\r\n              type=\"email\"\r\n              label=\"Customer Email\"\r\n              onChange={(e) => setEmail(e.target.value)}\r\n              required\r\n            />\r\n            <Input\r\n              name=\"remarks\"\r\n              type=\"textarea\"\r\n              label=\"Remarks\"\r\n              onChange={(e) => setRemarks(e.target.value)}\r\n              required\r\n            />\r\n            <Input\r\n              name=\"attachments\"\r\n              type=\"file\"\r\n              label=\"Attachments\"\r\n              multiple\r\n              onChange={(e) =>\r\n                attachmentsChangeHandler(e, (files) => setAttachments(files))\r\n              }\r\n              required\r\n            />\r\n          </div>\r\n          <div className=\"form-footer\">\r\n            <button className=\"p-1\">Send Feedback</button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    );\r\n}\r\n\r\nexport default FeedbackForm;\r\n","// Configurations:\r\n// 1. Backend endpoint depending on test vs live\r\n// 2.\r\n\r\nconst ENVIRON = process.env.NODE_ENV === \"development\" ? \"DEV\" : \"PROD\";\r\n\r\nconst CONF = {\r\n  DEV: {\r\n    baseUrl: \"http://localhost:8000/api\",\r\n    ROOT: \"http://localhost:8000\",\r\n  },\r\n  PROD: {\r\n    baseUrl: \"/api\",\r\n    ROOT: \"\",\r\n  },\r\n};\r\n\r\nexport const BASE_URL = CONF[ENVIRON].baseUrl;\r\nexport const ROOT_URL = CONF[ENVIRON].ROOT;\r\nexport const GOOGLE_API_KEY = \"AIzaSyDQ7WXCqy5-cyHTyho_XLgBDHJZe4n-nAw\";\r\n","import React from \"react\";\r\nimport MatIcon from \"../../components/icons/MatIcon\";\r\nimport { ROOT_URL } from \"../../conf\";\r\n\r\nfunction Attachment({ doc }) {\r\n  console.log(doc);\r\n  let split = doc.file.split(\"/\");\r\n  let name = split[split.length - 1];\r\n  return (\r\n    <>\r\n      <span className=\"text-ellipsis\">{name}</span>\r\n      <a\r\n        href={`${ROOT_URL}/media/${doc.file}`}\r\n        className=\"borded-link\"\r\n        download\r\n      >\r\n        <MatIcon name=\"arrow_downward\" />\r\n      </a>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Attachment;\r\n","import React from \"react\";\r\nimport { COMPLAINT_ATTACHMENTS } from \"../../helpers/GraphQL\";\r\nimport { useQuery } from \"@apollo/react-hooks\";\r\nimport Attachment from \"./Attachment\";\r\n\r\nfunction ComplaintAttachements({ complaint_id }) {\r\n  const { loading, error, data } = useQuery(COMPLAINT_ATTACHMENTS, {\r\n    variables: { complaint_id: complaint_id },\r\n  });\r\n  if (loading || error) {\r\n    return null;\r\n  }\r\n  const attachments = data.complaintAttachments;\r\n  return (\r\n    <ul className=\"attachments mb-1\">\r\n      <li>\r\n        <b>Attachments</b>\r\n      </li>\r\n      {attachments.length ? (\r\n        attachments.map((doc) => (\r\n          <li key={doc.id}>\r\n            <Attachment doc={doc} />\r\n          </li>\r\n        ))\r\n      ) : (\r\n        <li>None</li>\r\n      )}\r\n    </ul>\r\n  );\r\n}\r\n\r\nexport default ComplaintAttachements;\r\n","import React, { useState } from \"react\";\r\nimport { withRouter } from \"react-router\";\r\nimport { GET_COMPLAINT } from \"../../helpers/GraphQL\";\r\nimport useProfile from \"../../components/hooks/useProfile\";\r\nimport { useQuery } from \"@apollo/react-hooks\";\r\nimport { NavLink } from \"react-router-dom\";\r\nimport MatIcon from \"../../components/icons/MatIcon\";\r\nimport { useRef } from \"react\";\r\nimport Modal from \"../../components/modals/Modal\";\r\nimport FeedbackForm from \"./FeedbackForm\";\r\nimport ComplaintAttachements from \"./ComplaintAttachements\";\r\nlet dayjs = require(\"dayjs\");\r\nlet html2canvas = require(\"html2canvas\");\r\n\r\nfunction ComplaintDetailViewPage({ match }) {\r\n  useProfile();\r\n  const detailsView = useRef(null);\r\n  const [feedback, setFeedback] = useState(null);\r\n  const [img, setImg] = useState(null);\r\n  const { loading, error, data } = useQuery(GET_COMPLAINT, {\r\n    variables: { id: match.params.id },\r\n  });\r\n\r\n  error && console.error(error);\r\n  if (loading) return <p>Loading...</p>;\r\n  if (error) return <p>Error :(</p>;\r\n  let complaint = data.complaint;\r\n  function calc_kpi_days(open, close) {\r\n    console.log(`Open: ${open}`, `Close: ${close}`);\r\n    if (!close) {\r\n      close = dayjs().format(\"YYYY-MM-DD\");\r\n    }\r\n    if (open.indexOf(\"T\")) open = open.split(\"T\")[0];\r\n    if (close.indexOf(\"T\")) close = close.split(\"T\")[0];\r\n    console.log(`Open: ${open}`, `Close: ${close}`);\r\n    return dayjs(close).diff(dayjs(open), \"day\");\r\n  }\r\n  function detailsImage(e) {\r\n    let btn = e.target;\r\n    console.log(btn);\r\n    html2canvas(detailsView.current, { scrollY: -window.scrollY }).then(\r\n      (canvas) => {\r\n        // document.body.appendChild(canvas);\r\n        console.log(canvas);\r\n        let dt = canvas.toDataURL(\"image/png\");\r\n        // downloadURI(dt, \"test.png\");\r\n        setImg(dt);\r\n        setFeedback(true);\r\n      }\r\n    );\r\n  }\r\n  const {\r\n    id,\r\n    clientName,\r\n    location,\r\n    nature,\r\n    openDate,\r\n    details,\r\n    actionPlan,\r\n    closeDate,\r\n    costCenter,\r\n    financialImpact,\r\n    rca,\r\n    responsiblePerson,\r\n    results,\r\n    status,\r\n    assignedTo,\r\n    assignedAt,\r\n    closedBy,\r\n  } = complaint;\r\n  const fmtDate = (strDate) => {\r\n    if (strDate) {\r\n      if (strDate.indexOf(\"T\")) strDate = strDate.split(\"T\")[0];\r\n      return dayjs(strDate).format(\"DD/MM/YYYY\");\r\n    }\r\n    return null;\r\n  };\r\n  return (\r\n    <div className=\"details\">\r\n      <div className=\"toolbar\">\r\n        <div className=\"titlebar\">\r\n          <NavLink to=\"/complaints\" className=\"btn btn-light mr-1\">\r\n            <MatIcon name=\"keyboard_arrow_left\" />\r\n          </NavLink>\r\n          <h5>Complete Complaint Information</h5>\r\n        </div>\r\n      </div>\r\n      <div className=\"details-grid\" ref={detailsView}>\r\n        <div className=\"grid-form-details\">\r\n          <div>\r\n            <label>Client Name</label>\r\n            <p>{clientName}</p>\r\n          </div>\r\n          <div>\r\n            <label>Location</label>\r\n            <p>{location.name}</p>\r\n          </div>\r\n          <div>\r\n            <label>Nature</label>\r\n            <p>{nature.name}</p>\r\n          </div>\r\n          <div>\r\n            <label>Open Date</label>\r\n            <p>{fmtDate(openDate)}</p>\r\n          </div>\r\n          <div className=\"span\">\r\n            <label>Details</label>\r\n            <p>{details}</p>\r\n          </div>\r\n          <div>\r\n            <label>Action Plan</label>\r\n            <p>{actionPlan}</p>\r\n          </div>\r\n          <div>\r\n            <label>Root Cause Analysis</label>\r\n            <p>{rca}</p>\r\n          </div>\r\n          <div className=\"span\">\r\n            <label>Results</label>\r\n            <p>{results}</p>\r\n          </div>\r\n          <div className=\"span\">\r\n            <label>Financial Impact</label>\r\n            <p>{financialImpact}</p>\r\n          </div>\r\n          <div>\r\n            <label>Cost Center</label>\r\n            <p>{costCenter}</p>\r\n          </div>\r\n          <div>\r\n            <label>Responsible Person</label>\r\n            <p>{responsiblePerson}</p>\r\n          </div>\r\n        </div>\r\n        <div className=\"sidebar mt-1 bg-light\">\r\n          <div className=\"status\">\r\n            <label>\r\n              Status: <span>{status}</span>\r\n            </label>\r\n          </div>\r\n          <ul>\r\n            {openDate && (\r\n              <li>\r\n                <MatIcon name=\"done\" />\r\n                On {fmtDate(openDate)}, Created\r\n              </li>\r\n            )}\r\n            {assignedTo && (\r\n              <li>\r\n                <MatIcon name=\"done\" />\r\n                On {fmtDate(assignedAt)}, Assigned to {assignedTo.username}\r\n              </li>\r\n            )}\r\n            {closedBy && (\r\n              <li>\r\n                <MatIcon name=\"done\" />\r\n                On {fmtDate(closeDate)}, Closed by {closedBy.username}\r\n              </li>\r\n            )}\r\n            <li className=\"kpi\">\r\n              KPI:\r\n              <span className=\"ml-1\">\r\n                <b>{calc_kpi_days(openDate, closeDate)}</b> day(s)\r\n              </span>\r\n            </li>\r\n          </ul>\r\n          <ComplaintAttachements complaint_id={id} />\r\n          {status === \"COMPLETED\" && (\r\n            <button className=\"send-feedback btn ripple\" onClick={detailsImage}>\r\n              <MatIcon name=\"mail_outline\" text=\"Send Feedback To Customer\" />\r\n            </button>\r\n          )}\r\n        </div>\r\n      </div>\r\n      {feedback && (\r\n        <Modal\r\n          title={`Feedback To: ${complaint.clientName}`}\r\n          onClose={() => setFeedback(false)}\r\n        >\r\n          <FeedbackForm\r\n            complaint={complaint}\r\n            img={img}\r\n            onComplete={() => setFeedback(false)}\r\n          />\r\n        </Modal>\r\n      )}\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withRouter(ComplaintDetailViewPage);\r\n","import React, { useState } from \"react\";\r\nimport { NATURES, LOCATIONS, GET_STATUSES } from \"../../helpers/GraphQL\";\r\nimport FilterExport from \"../../components/forms/FilterExport\";\r\nimport { Dates } from \"../../helpers/Dates\";\r\n\r\nfunction FilterForm({ handleSubmit, handleExport, filter = {} }) {\r\n  console.log(filter);\r\n  const [formData, setFormData] = useState(filter);\r\n  const searchFields = [\r\n    { name: \"clientName\", label: \"Client Name\" },\r\n    {\r\n      name: \"location\",\r\n      label: \"Location\",\r\n      type: \"select\",\r\n      query: { name: LOCATIONS, data: \"locations\" },\r\n      defaultValue: filter[\"location\"],\r\n    },\r\n    {\r\n      name: \"nature\",\r\n      label: \"Nature\",\r\n      type: \"select\",\r\n      query: { name: NATURES, data: \"natures\" },\r\n      defaultValue: filter[\"nature\"],\r\n    },\r\n    {\r\n      name: \"status\",\r\n      label: \"Status\",\r\n      type: \"select\",\r\n      query: { name: GET_STATUSES, data: \"statuses\" },\r\n      defaultValue: filter[\"status\"],\r\n    },\r\n    {\r\n      name: \"dateFrom\",\r\n      label: \"From\",\r\n      type: \"date\",\r\n      defaultValue: filter[\"dateFrom\"] || Dates.fmt(Date.now()),\r\n    },\r\n    {\r\n      name: \"dateTo\",\r\n      label: \"To\",\r\n      type: \"date\",\r\n      defaultValue: filter[\"dateTo\"] || Dates.fmt(Date.now()),\r\n    },\r\n  ];\r\n  function handleChange(e) {\r\n    const { value, name } = e.target;\r\n    setFormData({ ...formData, [name]: value || null });\r\n  }\r\n\r\n  return (\r\n    <FilterExport\r\n      handleSubmit={(e) => {\r\n        e.preventDefault();\r\n        handleSubmit(formData);\r\n      }}\r\n      fields={searchFields}\r\n      handleChange={handleChange}\r\n      handleExport={(e) => {\r\n        e.preventDefault();\r\n        handleExport(formData);\r\n      }}\r\n    />\r\n  );\r\n}\r\n\r\nexport default FilterForm;\r\n","import React, { useState } from \"react\";\r\nimport { useLazyQuery } from \"@apollo/react-hooks\";\r\nimport { Route, NavLink } from \"react-router-dom\";\r\n\r\nimport Table from \"../components/tables/Table\";\r\nimport MatIcon from \"../components/icons/MatIcon\";\r\nimport { COMPLAINTS } from \"../helpers/GraphQL\";\r\nimport NewComplaintRegisterPage from \"./complaints/NewComplaintRegisterPage\";\r\nimport Modal from \"../components/modals/Modal\";\r\nimport AssignComplaintPopup from \"./complaints/AssignComplaintPopup\";\r\nimport UpdateComplaintForm from \"./complaints/UpdateComplaintForm\";\r\nimport useProfile from \"../components/hooks/useProfile\";\r\nimport Pagination from \"../components/tables/Pagination\";\r\nimport { useEffect } from \"react\";\r\nimport ComplaintDetailViewPage from \"./complaints/ComplaintDetailViewPage\";\r\nimport FilterForm from \"./complaints/FilterForm\";\r\nimport { BASE_URL } from \"../conf\";\r\nconst PAGE_SIZE = 10;\r\nfunction ComplaintsPage() {\r\n  useProfile();\r\n  const [pageNo, setPageNo] = useState(1);\r\n  const [filter, setFilter] = useState(new Map());\r\n  const [getComplaints, { loading, data, error }] = useLazyQuery(COMPLAINTS, {\r\n    variables: { pageSize: PAGE_SIZE, pageNo: pageNo, ...filter },\r\n  });\r\n\r\n  useEffect(() => {\r\n    const abortCtrl = new AbortController();\r\n    console.log(\"Start\");\r\n    getComplaints();\r\n\r\n    return function cleanup() {\r\n      abortCtrl.abort();\r\n    };\r\n  }, [pageNo, filter]);\r\n\r\n  function handleSubmit(formData) {\r\n    console.log(formData);\r\n    let params = new Map();\r\n    for (const [key, value] of Object.entries(formData)) {\r\n      if (value) {\r\n        params[key] = value;\r\n      }\r\n    }\r\n    console.log(\"Params: \", params);\r\n    setFilter(params);\r\n    setPageNo(1);\r\n  }\r\n\r\n  function handleExport(formData) {\r\n    let params = new Map();\r\n    for (const [key, value] of Object.entries(formData)) {\r\n      if (value) {\r\n        params[key] = value;\r\n      }\r\n    }\r\n    let q = Object.keys(params)\r\n      .map((key) => key + \"=\" + params[key])\r\n      .join(\"&\");\r\n    fetch(`${BASE_URL}/export-complaints?${q}`)\r\n      .then((response) => response.blob())\r\n      .then((blob) => {\r\n        var url = window.URL.createObjectURL(blob);\r\n        var a = document.createElement(\"a\");\r\n        a.href = url;\r\n        a.download = \"Export.xlsx\";\r\n        document.body.appendChild(a);\r\n        a.click();\r\n        a.remove();\r\n      });\r\n  }\r\n\r\n  function handlePageChange(newPageNo) {\r\n    setPageNo(newPageNo);\r\n  }\r\n\r\n  const [assign, setAssign] = useState(false);\r\n  const [selected, setSelected] = useState(null);\r\n\r\n  if (loading) return <p>Loading...</p>;\r\n  if (error) return <p>Error :(</p>;\r\n\r\n  const columns = [\r\n    { name: \"id\", label: \"ID\" },\r\n    { name: \"clientName\", label: \"Client Name\" },\r\n    { name: \"location_name\", label: \"Location\" },\r\n    { name: \"openDate\", label: \"Open Date\" },\r\n    { name: \"nature_name\", label: \"Nature of Complaint\" },\r\n    { name: \"status\", label: \"Status\" },\r\n    {\r\n      name: \"assigned_to\",\r\n      label: \"Assigned To\",\r\n      render: (row) =>\r\n        row.assignedTo ? (\r\n          <span>{row.assignedTo.username}</span>\r\n        ) : (\r\n          <button\r\n            onClick={() => {\r\n              setAssign(true);\r\n              setSelected(row);\r\n            }}\r\n          >\r\n            Assign\r\n          </button>\r\n        ),\r\n    },\r\n    { name: \"details\", label: \"Details\", className: \"col-ellipsis\" },\r\n    {\r\n      name: \"updateDetails\",\r\n      label: \"\",\r\n      render: (row) =>\r\n        row.status === \"ASSIGNED\" ? (\r\n          <NavLink\r\n            className=\"btn btn-light p-1 d-flex align-left\"\r\n            to={`/complaints/update/${row.id}`}\r\n          >\r\n            <MatIcon name=\"settings\" text=\"Complete\" />\r\n          </NavLink>\r\n        ) : null,\r\n    },\r\n    {\r\n      name: \"viewDetails\",\r\n      render: (row) => (\r\n        <NavLink to={`/complaints/view/${row.id}`} className=\"d-flex\">\r\n          <MatIcon name=\"unfold_more\" />\r\n        </NavLink>\r\n      ),\r\n    },\r\n  ];\r\n  const fmtDate = (strDate) => {\r\n    let parsed = Date.parse(strDate);\r\n    return new Date(parsed).toLocaleDateString(\"en-GB\");\r\n  };\r\n  const records = data\r\n    ? data.complaints.map((r) => ({\r\n        ...r,\r\n        nature_name: r.nature.name,\r\n        location_name: r.location ? r.location.name : \"\",\r\n        openDate: fmtDate(r.openDate),\r\n      }))\r\n    : [];\r\n  return (\r\n    <>\r\n      <Route path=\"/complaints\" exact>\r\n        <div className=\"toolbar\">\r\n          <h5>List of complaints</h5>\r\n          <NavLink\r\n            className=\"d-flex btn has-left-icon\"\r\n            to=\"/complaints/new-complaint\"\r\n          >\r\n            <MatIcon name=\"add\" text=\"New Complaint\" />\r\n          </NavLink>\r\n        </div>\r\n        <hr />\r\n        <div className=\"toolbar\">\r\n          {data && (\r\n            <FilterForm\r\n              handleSubmit={handleSubmit}\r\n              filter={filter}\r\n              handleExport={handleExport}\r\n            />\r\n          )}\r\n        </div>\r\n        <Table columns={columns} data={records} />\r\n        {data && (\r\n          <Pagination\r\n            pageNo={pageNo}\r\n            onPageChanged={handlePageChange}\r\n            lastPage={data.complaints.length < PAGE_SIZE}\r\n          />\r\n        )}\r\n      </Route>\r\n      <Route path=\"/complaints/new-complaint\" exact>\r\n        <NewComplaintRegisterPage />\r\n      </Route>\r\n      <Route path=\"/complaints/update/:id\" exact>\r\n        <UpdateComplaintForm />\r\n      </Route>\r\n      <Route path=\"/complaints/view/:id\" exact>\r\n        <ComplaintDetailViewPage />\r\n      </Route>\r\n      {assign && (\r\n        <Modal title={selected.clientName} onClose={() => setAssign(false)}>\r\n          <AssignComplaintPopup\r\n            complaint={selected}\r\n            onComplete={() => setAssign(false)}\r\n          />\r\n        </Modal>\r\n      )}\r\n    </>\r\n  );\r\n}\r\n\r\nexport default ComplaintsPage;\r\n","import React, { useState } from \"react\";\r\nimport { NavLink, Redirect } from \"react-router-dom\";\r\nimport MatIcon from \"../../components/icons/MatIcon\";\r\nimport { REGISTER_USER, USERS, USERS_GET_ME } from \"../../helpers/UsersGraphQL\";\r\nimport { useMutation } from \"@apollo/react-hooks\";\r\nimport Input from \"../../components/forms/Input\";\r\n\r\nfunction NewUserPage() {\r\n  const [redirect, setRedirect] = useState(null);\r\n  const [formData, setFormData] = useState(new Map());\r\n  const [registerUser, { loading }] = useMutation(REGISTER_USER);\r\n\r\n  function handleSubmit(e) {\r\n    e.preventDefault();\r\n    registerUser({\r\n      variables: {\r\n        ...formData,\r\n      },\r\n      refetchQueries: [{ query: USERS }, { query: USERS_GET_ME }],\r\n    }).then(\r\n      () => setRedirect(\"/users\"),\r\n      (res) => console.log(\"Error: \", res)\r\n    );\r\n  }\r\n  function handleChange(e) {\r\n    const { value, name } = e.target;\r\n    setFormData({ ...formData, [name]: value });\r\n  }\r\n  return redirect ? (\r\n    <Redirect to={redirect} />\r\n  ) : (\r\n    <div>\r\n      <div className=\"toolbar\">\r\n        <div className=\"titlebar\">\r\n          <NavLink to=\"/users\" className=\"btn btn-light mr-1\">\r\n            <MatIcon name=\"keyboard_arrow_left\" />\r\n          </NavLink>\r\n          <h5>Register New User</h5>\r\n        </div>\r\n      </div>\r\n      {loading && <p>Sending ....</p>}\r\n      <form className=\"form form-medium\" onSubmit={handleSubmit}>\r\n        <div>\r\n          <Input\r\n            name=\"username\"\r\n            label=\"Username\"\r\n            onChange={handleChange}\r\n            required\r\n          />\r\n          <Input\r\n            name=\"email\"\r\n            label=\"Email Address\"\r\n            onChange={handleChange}\r\n            type=\"email\"\r\n            required\r\n          />\r\n          <Input\r\n            name=\"firstName\"\r\n            label=\"First Name\"\r\n            onChange={handleChange}\r\n            required\r\n          />\r\n          <Input\r\n            name=\"lastName\"\r\n            label=\"Last Name\"\r\n            onChange={handleChange}\r\n            required\r\n          />\r\n        </div>\r\n        <div className=\"form-footer\">\r\n          <button>Submit</button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default NewUserPage;\r\n","import React, { useState } from \"react\";\r\nimport { NavLink, Redirect, withRouter } from \"react-router-dom\";\r\nimport MatIcon from \"../../components/icons/MatIcon\";\r\nimport {\r\n  REGISTER_USER,\r\n  USERS,\r\n  USERS_GET_ME,\r\n  GET_USER,\r\n} from \"../../helpers/UsersGraphQL\";\r\nimport { useMutation, useQuery } from \"@apollo/react-hooks\";\r\nimport Input from \"../../components/forms/Input\";\r\n\r\nfunction UpdateUserPage({ match }) {\r\n  const [redirect, setRedirect] = useState(null);\r\n  const [formData, setFormData] = useState(new Map());\r\n  const [registerUser, {}] = useMutation(REGISTER_USER);\r\n  const { loading, error, data } = useQuery(GET_USER, {\r\n    variables: { id: match.params.id },\r\n  });\r\n  if (loading) return <p>Loading...</p>;\r\n  if (error) return <p>Error :(</p>;\r\n  let user = data.user;\r\n\r\n  function handleSubmit(e) {\r\n    e.preventDefault();\r\n    let prev = new Map();\r\n    Object.keys(user).forEach((key) => {\r\n      if (!formData[key]) {\r\n        prev[key] = user[key];\r\n      }\r\n    });\r\n\r\n    registerUser({\r\n      variables: { ...formData, ...prev, id: user.id },\r\n      refetchQueries: [{ query: USERS }, { query: USERS_GET_ME }],\r\n    }).then(\r\n      () => setRedirect(\"/users\"),\r\n      (res) => console.log(\"Error: \", res)\r\n    );\r\n  }\r\n  function handleChange(e) {\r\n    const { value, name } = e.target;\r\n    setFormData({ ...formData, [name]: value });\r\n  }\r\n  return redirect ? (\r\n    <Redirect to={redirect} />\r\n  ) : (\r\n    <div>\r\n      <div className=\"toolbar\">\r\n        <div className=\"titlebar\">\r\n          <NavLink to=\"/users\" className=\"btn btn-light mr-1\">\r\n            <MatIcon name=\"keyboard_arrow_left\" />\r\n          </NavLink>\r\n          <h5>Update User</h5>\r\n        </div>\r\n      </div>\r\n      {loading && <p>Sending ....</p>}\r\n      <form className=\"form form-medium\" onSubmit={handleSubmit}>\r\n        <div>\r\n          <Input\r\n            name=\"username\"\r\n            label=\"Username\"\r\n            onChange={handleChange}\r\n            required\r\n            defaultValue={user.username}\r\n            readOnly={true}\r\n          />\r\n          <Input\r\n            name=\"email\"\r\n            label=\"Email Address\"\r\n            onChange={handleChange}\r\n            type=\"email\"\r\n            required\r\n            defaultValue={user.email}\r\n          />\r\n          <Input\r\n            name=\"firstName\"\r\n            label=\"First Name\"\r\n            onChange={handleChange}\r\n            required\r\n            defaultValue={user.firstName}\r\n          />\r\n          <Input\r\n            name=\"lastName\"\r\n            label=\"Last Name\"\r\n            onChange={handleChange}\r\n            required\r\n            defaultValue={user.lastName}\r\n          />\r\n        </div>\r\n        <div className=\"form-footer\">\r\n          <button>Submit</button>\r\n        </div>\r\n      </form>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default withRouter(UpdateUserPage);\r\n","import React from \"react\";\r\nimport { USERS } from \"../helpers/UsersGraphQL\";\r\nimport NewUserPage from \"./users/NewUserPage\";\r\nimport { useQuery } from \"@apollo/react-hooks\";\r\nimport { Route, NavLink } from \"react-router-dom\";\r\nimport MatIcon from \"../components/icons/MatIcon\";\r\nimport Table from \"../components/tables/Table\";\r\nimport useProfile from \"../components/hooks/useProfile\";\r\nimport UpdateUserPage from \"./users/UpdateUserPage\";\r\n\r\nfunction UserManagementPage() {\r\n  useProfile();\r\n  const { loading, error, data } = useQuery(USERS);\r\n  if (loading) return null;\r\n  if (error) {\r\n    return <p>Error (:</p>;\r\n  }\r\n  const columns = [\r\n    { name: \"id\", label: \"ID\" },\r\n    { name: \"username\", label: \"Client Name\" },\r\n    { name: \"email\", label: \"Email\" },\r\n    { name: \"name\", label: \"Full Name\" },\r\n    {\r\n      name: \"actions\",\r\n      label: \"\",\r\n      render: (row) => (\r\n        <div>\r\n          <a href={`/users/update/${row.id}`} className=\"d-flex align-left\">\r\n            <MatIcon name=\"edit\" text=\"Edit\" />\r\n          </a>\r\n        </div>\r\n      ),\r\n    },\r\n  ];\r\n\r\n  const records = data.users.map((r) => ({\r\n    ...r,\r\n    name: r.firstName ? `${r.firstName} ${r.lastName}` : null,\r\n  }));\r\n  return (\r\n    <>\r\n      <Route path=\"/users\" exact>\r\n        <div className=\"toolbar\">\r\n          <h5>List of users</h5>\r\n          <NavLink\r\n            className=\"d-flex btn btn-light has-left-icon\"\r\n            to=\"/users/new-user\"\r\n          >\r\n            <MatIcon name=\"add\" text=\"New User\" />\r\n          </NavLink>\r\n        </div>\r\n        <Table columns={columns} data={records} />\r\n      </Route>\r\n      <Route path=\"/users/new-user\" exact>\r\n        <NewUserPage />\r\n      </Route>\r\n      <Route path=\"/users/update/:id\" exact>\r\n        <UpdateUserPage />\r\n      </Route>\r\n    </>\r\n  );\r\n}\r\n\r\nexport default UserManagementPage;\r\n","const ACCESS_TOKEN = \"AccessToken\";\r\n\r\nconst AuthHelper = {\r\n  saveToken: (token, cb) => {\r\n    sessionStorage.setItem(ACCESS_TOKEN, token);\r\n    cb(true);\r\n  },\r\n  getToken: () => sessionStorage.getItem(ACCESS_TOKEN),\r\n  removeToken: () => sessionStorage.removeItem(ACCESS_TOKEN),\r\n};\r\n\r\nexport default AuthHelper;\r\n","import React, { useState } from \"react\";\r\nimport Input from \"../components/forms/Input\";\r\nimport MatIcon from \"../components/icons/MatIcon\";\r\nimport AuthHelper from \"../helpers/AuthHelper\";\r\nimport { Redirect } from \"react-router-dom\";\r\nimport { useMutation } from \"@apollo/react-hooks\";\r\nimport { USERS_GET_TOKEN } from \"../helpers/UsersGraphQL\";\r\n\r\nfunction LoginPage() {\r\n  const [formData, setFormData] = useState(new Map());\r\n  const [redirect, setRedirect] = useState(null);\r\n  const [login, { client }] = useMutation(USERS_GET_TOKEN);\r\n  function handleSubmit(e) {\r\n    e.preventDefault();\r\n    client.clearStore();\r\n    login({\r\n      variables: {\r\n        ...formData,\r\n      },\r\n    }).then(\r\n      (res) => {\r\n        if (res.data) {\r\n          let { token } = res.data.tokenAuth;\r\n          AuthHelper.saveToken(token, () => {\r\n            setRedirect(\"/\");\r\n          });\r\n        }\r\n      },\r\n      (res) => console.log(\"Error: \", res)\r\n    );\r\n  }\r\n  function handleChange(e) {\r\n    const { value, name } = e.target;\r\n    setFormData({ ...formData, [name]: value });\r\n  }\r\n  return redirect ? (\r\n    <Redirect to={redirect} />\r\n  ) : (\r\n      <>\r\n        <div className=\"login-page box-shadow\">\r\n          <div className=\"login-header d-flex mb-1 p-1\">\r\n            <h3>Twiga - CCMS</h3>\r\n            <img\r\n              src={\r\n                process.env.PUBLIC_URL + \"/static/images/complaints_register.png\"\r\n              }\r\n              alt=\"Image\"\r\n            />\r\n          </div>\r\n          <form className=\"form\" onSubmit={handleSubmit}>\r\n            <div className=\"mt-1\">\r\n              <Input\r\n                name=\"username\"\r\n                label=\"Username\"\r\n                onChange={handleChange}\r\n                required\r\n              />\r\n              <Input\r\n                name=\"password\"\r\n                label=\"Password\"\r\n                type=\"password\"\r\n                onChange={handleChange}\r\n                required\r\n              />\r\n            </div>\r\n            <div className=\"form-footer\">\r\n              <button>\r\n                <span className=\"mr-1\">Login</span>\r\n                <MatIcon name=\"login\" />\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </>\r\n    );\r\n}\r\n\r\nexport default LoginPage;\r\n","import React from \"react\";\r\nimport MatIcon from \"../icons/MatIcon\";\r\n\r\nfunction Modal({ onClose, title, children, posx, posy, ...props }) {\r\n  const showHideClassName = \"modal display-block\";\r\n  return (\r\n    <div className={showHideClassName} {...props}>\r\n      <div className=\"modal-main\">\r\n        <div className=\"modal-header\">\r\n          {title ? <h5 className=\"modal-title\">{title}</h5> : <span></span>}\r\n          <div className=\"btn-group\">\r\n            <button\r\n              type=\"button\"\r\n              className=\"btn text-warning m-1\"\r\n              onClick={onClose}\r\n            >\r\n              <MatIcon name=\"close\" />\r\n            </button>\r\n          </div>\r\n        </div>\r\n        <div className=\"modal-content\">{children}</div>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Modal;\r\n","import { useMutation } from '@apollo/react-hooks';\nimport React, { useRef, useState } from 'react'\nimport Input from '../../components/forms/Input'\nimport { CHANGE_PASSWORD, USERS, USERS_GET_ME } from '../../helpers/UsersGraphQL';\nimport { NavLink, Redirect } from \"react-router-dom\";\n\nexport default function ChangePasswordForm() {\n    const [formData, setFormData] = useState(new Map());\n    const [fail, setFail] = useState();\n    let [changePassword, { loading }] = useMutation(CHANGE_PASSWORD)\n    const [redirect, setRedirect] = useState(null);\n    const formEl = useRef(null);\n    function handleSubmit(e) {\n        e.preventDefault();\n        changePassword({\n            variables: {\n                ...formData,\n            },\n            refetchQueries: [{ query: USERS }, { query: USERS_GET_ME }],\n        }).then(\n            () => setRedirect(\"/login\"),\n            (res) => {\n                setFail(\"Authentication failed, check your inputs\")\n                formEl.current.reset()\n            }\n        );\n    }\n    console.log(fail)\n    function handleChange(e) {\n        const { value, name } = e.target;\n        setFormData({ ...formData, [name]: value });\n    }\n    return redirect ? (\n        <Redirect to={redirect} />\n    ) : (\n            <form ref={formEl} className=\"form\" onSubmit={handleSubmit}>\n                <div>\n                    <Input\n                        name=\"password\"\n                        label=\"Current Password\"\n                        onChange={handleChange}\n                        required\n                    />\n                    <Input\n                        name=\"newPassword\"\n                        label=\"New Password\"\n                        onChange={handleChange}\n                        required\n                    />\n                </div>\n\n                <div className=\"form-footer\">\n                    <button onSubmit={handleSubmit}>Submit</button>\n                </div>\n                <small className=\"p-1 error\">{fail}</small>\n            </form>\n        )\n}\n","import { useQuery } from '@apollo/react-hooks';\nimport React, { useState } from 'react'\nimport Input from '../../components/forms/Input';\nimport Modal from '../../components/modals/Modal_';\nimport { USERS_GET_ME } from '../../helpers/UsersGraphQL';\nimport ChangePasswordForm from './ChangePasswordForm';\n\nexport default function UserProfilePage() {\n    const [formOpen, setFormOpen] = useState()\n    let { loading, error, data } = useQuery(USERS_GET_ME);\n    if (loading) return <p>Loading...</p>;\n    if (error) return <p>Error :(</p>;\n    const user = data.me;\n    console.log(user)\n    return (\n        <div className=\"user-profile\">\n            <div className=\"info\">\n                <div className=\"profile-photo\">\n                    <label htmlFor=\"photo\" className=\"photo\">\n                        <img src=\"/static/images/user.jpg\" alt=\"User\" />\n                        <Input\n                            type=\"file\"\n                            accept=\"image/*\"\n                            id=\"photo\"\n                            name=\"photo\"\n                        />\n                    </label>\n                </div>\n                <div>\n                    <h3>{user.username}</h3>\n                    <small>\n                        {user.isSuperuser ? <span>Administrator</span> : <span>User</span>}\n                    </small>\n                </div>\n            </div>\n            <table>\n                <tbody>\n                    <tr><th>First Name</th><td>{user.firstName}</td></tr>\n                    <tr><th>Last Name</th><td>{user.lastName}</td></tr>\n                    <tr><th>Email Name</th><td>{user.email}</td></tr>\n                </tbody>\n            </table>\n            <div className=\"update\">\n                <button\n                    onClick={() => setFormOpen(!formOpen)}\n                >\n                    Change password\n                </button>\n            </div>\n            {formOpen && <Modal title=\"Change My Password\" onClose={() => setFormOpen(false)}>\n                <ChangePasswordForm onComplete={setFormOpen} />\n            </Modal>}\n        </div>\n    )\n}\n","import React from \"react\";\r\nimport NavBar from \"./components/nav/NavBar\";\r\nimport { BrowserRouter as Router, Switch, Route } from \"react-router-dom\";\r\nimport HomePage from \"./pages/HomePage\";\r\nimport ApolloClient from \"apollo-boost\";\r\nimport { ApolloProvider } from \"@apollo/react-hooks\";\r\nimport ComplaintsPage from \"./pages/ComplaintsPage\";\r\nimport UserManagementPage from \"./pages/UserManagementPage\";\r\nimport LoginPage from \"./pages/LoginPage\";\r\nimport AuthHelper from \"./helpers/AuthHelper\";\r\nimport { BASE_URL } from \"./conf\";\r\nimport UserProfilePage from \"./pages/users/UserProfilePage\";\r\nconst getToken = () => {\r\n  const token = AuthHelper.getToken();\r\n  return token ? `JWT ${token}` : \"\";\r\n};\r\nconst requestMiddleware = (operation) => {\r\n  operation.setContext({\r\n    headers: {\r\n      Authorization: getToken(),\r\n    },\r\n  });\r\n};\r\nconst client = new ApolloClient({\r\n  uri: `${BASE_URL}/graphql`,\r\n  request: requestMiddleware,\r\n});\r\n\r\nfunction App() {\r\n  return (\r\n    <Router>\r\n      <ApolloProvider client={client}>\r\n        <Switch>\r\n          <Route path=\"/login\" exact>\r\n            <LoginPage />\r\n          </Route>\r\n          <Route path=\"/\">\r\n            <NavBar />\r\n            <section className=\"page-content container\">\r\n              <div className=\"content\">\r\n                <Switch>\r\n                  <Route path=\"/\" exact>\r\n                    <HomePage />\r\n                  </Route>\r\n                  <Route path=\"/complaints\">\r\n                    <ComplaintsPage />\r\n                  </Route>\r\n                  <Route path=\"/users\">\r\n                    <UserManagementPage />\r\n                  </Route>\r\n                  <Route path=\"/my-profile\">\r\n                    <UserProfilePage />\r\n                  </Route>\r\n                </Switch>\r\n              </div>\r\n            </section>\r\n          </Route>\r\n        </Switch>\r\n      </ApolloProvider>\r\n    </Router>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","// This optional code is used to register a service worker.\r\n// register() is not called by default.\r\n\r\n// This lets the app load faster on subsequent visits in production, and gives\r\n// it offline capabilities. However, it also means that developers (and users)\r\n// will only see deployed updates on subsequent visits to a page, after all the\r\n// existing tabs open on the page have been closed, since previously cached\r\n// resources are updated in the background.\r\n\r\n// To learn more about the benefits of this model and instructions on how to\r\n// opt-in, read https://bit.ly/CRA-PWA\r\n\r\nconst isLocalhost = Boolean(\r\n  window.location.hostname === 'localhost' ||\r\n    // [::1] is the IPv6 localhost address.\r\n    window.location.hostname === '[::1]' ||\r\n    // 127.0.0.0/8 are considered localhost for IPv4.\r\n    window.location.hostname.match(\r\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\r\n    )\r\n);\r\n\r\nexport function register(config) {\r\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\r\n    // The URL constructor is available in all browsers that support SW.\r\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\r\n    if (publicUrl.origin !== window.location.origin) {\r\n      // Our service worker won't work if PUBLIC_URL is on a different origin\r\n      // from what our page is served on. This might happen if a CDN is used to\r\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\r\n      return;\r\n    }\r\n\r\n    window.addEventListener('load', () => {\r\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\r\n\r\n      if (isLocalhost) {\r\n        // This is running on localhost. Let's check if a service worker still exists or not.\r\n        checkValidServiceWorker(swUrl, config);\r\n\r\n        // Add some additional logging to localhost, pointing developers to the\r\n        // service worker/PWA documentation.\r\n        navigator.serviceWorker.ready.then(() => {\r\n          console.log(\r\n            'This web app is being served cache-first by a service ' +\r\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\r\n          );\r\n        });\r\n      } else {\r\n        // Is not localhost. Just register service worker\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    });\r\n  }\r\n}\r\n\r\nfunction registerValidSW(swUrl, config) {\r\n  navigator.serviceWorker\r\n    .register(swUrl)\r\n    .then(registration => {\r\n      registration.onupdatefound = () => {\r\n        const installingWorker = registration.installing;\r\n        if (installingWorker == null) {\r\n          return;\r\n        }\r\n        installingWorker.onstatechange = () => {\r\n          if (installingWorker.state === 'installed') {\r\n            if (navigator.serviceWorker.controller) {\r\n              // At this point, the updated precached content has been fetched,\r\n              // but the previous service worker will still serve the older\r\n              // content until all client tabs are closed.\r\n              console.log(\r\n                'New content is available and will be used when all ' +\r\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\r\n              );\r\n\r\n              // Execute callback\r\n              if (config && config.onUpdate) {\r\n                config.onUpdate(registration);\r\n              }\r\n            } else {\r\n              // At this point, everything has been precached.\r\n              // It's the perfect time to display a\r\n              // \"Content is cached for offline use.\" message.\r\n              console.log('Content is cached for offline use.');\r\n\r\n              // Execute callback\r\n              if (config && config.onSuccess) {\r\n                config.onSuccess(registration);\r\n              }\r\n            }\r\n          }\r\n        };\r\n      };\r\n    })\r\n    .catch(error => {\r\n      console.error('Error during service worker registration:', error);\r\n    });\r\n}\r\n\r\nfunction checkValidServiceWorker(swUrl, config) {\r\n  // Check if the service worker can be found. If it can't reload the page.\r\n  fetch(swUrl, {\r\n    headers: { 'Service-Worker': 'script' },\r\n  })\r\n    .then(response => {\r\n      // Ensure service worker exists, and that we really are getting a JS file.\r\n      const contentType = response.headers.get('content-type');\r\n      if (\r\n        response.status === 404 ||\r\n        (contentType != null && contentType.indexOf('javascript') === -1)\r\n      ) {\r\n        // No service worker found. Probably a different app. Reload the page.\r\n        navigator.serviceWorker.ready.then(registration => {\r\n          registration.unregister().then(() => {\r\n            window.location.reload();\r\n          });\r\n        });\r\n      } else {\r\n        // Service worker found. Proceed as normal.\r\n        registerValidSW(swUrl, config);\r\n      }\r\n    })\r\n    .catch(() => {\r\n      console.log(\r\n        'No internet connection found. App is running in offline mode.'\r\n      );\r\n    });\r\n}\r\n\r\nexport function unregister() {\r\n  if ('serviceWorker' in navigator) {\r\n    navigator.serviceWorker.ready\r\n      .then(registration => {\r\n        registration.unregister();\r\n      })\r\n      .catch(error => {\r\n        console.error(error.message);\r\n      });\r\n  }\r\n}\r\n","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport App from \"./App\";\r\nimport * as serviceWorker from \"./serviceWorker\";\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\n// If you want your app to work offline and load faster, you can change\r\n// unregister() to register() below. Note this comes with some pitfalls.\r\n// Learn more about service workers: https://bit.ly/CRA-PWA\r\nserviceWorker.unregister();\r\n"],"sourceRoot":""}
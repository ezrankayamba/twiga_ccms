(this.webpackJsonpfrontend_web=this.webpackJsonpfrontend_web||[]).push([[0],{49:function(e,a,t){e.exports=t(64)},64:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),l=t(28),c=t.n(l),o=t(7),m=t(6),i=t(10),s=t(9);function u(){var e=Object(i.a)(["\n  mutation changePassword(\n    $password: String!\n    $newPassword: String!\n  ) {\n    changePassword(\n      password: $password\n      newPassword: $newPassword\n    ) {\n      user {\n        id\n        username\n        dateJoined\n        firstName\n        lastName\n        lastLogin\n        email\n        isStaff\n        isSuperuser\n      }\n    }\n  }\n"]);return u=function(){return e},e}function d(){var e=Object(i.a)(["\n  query getUser($id: ID!) {\n    user(id: $id) {\n      id\n      username\n      dateJoined\n      firstName\n      lastName\n      lastLogin\n      email\n      isStaff\n      isSuperuser\n    }\n  }\n"]);return d=function(){return e},e}function b(){var e=Object(i.a)(["\n  mutation registerUser(\n    $id: ID\n    $username: String!\n    $email: String!\n    $firstName: String\n    $lastName: String\n  ) {\n    registerUser(\n      id: $id\n      username: $username\n      email: $email\n      firstName: $firstName\n      lastName: $lastName\n    ) {\n      user {\n        id\n        username\n        dateJoined\n        firstName\n        lastName\n        lastLogin\n        email\n        isStaff\n        isSuperuser\n      }\n    }\n  }\n"]);return b=function(){return e},e}function f(){var e=Object(i.a)(["\n  query getUsers {\n    users {\n      id\n      username\n      dateJoined\n      firstName\n      lastName\n      lastLogin\n      email\n      isStaff\n      isSuperuser\n    }\n  }\n"]);return f=function(){return e},e}function p(){var e=Object(i.a)(["\n  query getMe {\n    me {\n      id\n      username\n      dateJoined\n      firstName\n      lastName\n      lastLogin\n      email\n      isStaff\n      isSuperuser\n    }\n  }\n"]);return p=function(){return e},e}function E(){var e=Object(i.a)(["\n  mutation getToken($username: String!, $password: String!) {\n    tokenAuth(username: $username, password: $password) {\n      token\n    }\n  }\n"]);return E=function(){return e},e}var g=Object(s.b)(E()),v=Object(s.b)(p()),O=Object(s.b)(f()),h=Object(s.b)(b()),j=Object(s.b)(d()),N=Object(s.b)(u());var y=function(e){var a=Object(m.c)(v),t=a.loading,n=a.error,l=a.data;return t?r.a.createElement("p",null,"Loading..."):n?r.a.createElement("p",null,"Error :("):(console.log(l),r.a.createElement("div",{className:"user-profile-nav"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(o.b,{exact:!0,to:"/my-profile"},l.me.username)),r.a.createElement("li",null,r.a.createElement(o.b,{exact:!0,to:"/login"},"Logout")))))},S=t(8);var C=function(){var e=Object(S.g)(),a=Object(m.c)(v),t=a.loading,n=a.error,r=a.data;if(t)return null;if(n){if(n.graphQLErrors.length){var l=n.graphQLErrors[0].message;"Signature has expired"!==l&&"You do not have permission to perform this action"!==l||e.push("/login")}return console.log(n),null}return r};var w=function(){var e=C();return console.log(e),r.a.createElement("header",{className:"navbar container"},r.a.createElement("div",{className:"content"},r.a.createElement("h3",null,"Twiga - CCMS"),r.a.createElement("div",{className:"nav-links"},r.a.createElement("ul",null,r.a.createElement("li",null,r.a.createElement(o.b,{exact:!0,to:"/"},"Home")),r.a.createElement("li",null,r.a.createElement(o.b,{to:"/complaints"},"Complaints")),e&&e.me&&e.me.isSuperuser&&r.a.createElement("li",null,r.a.createElement(o.b,{to:"/users"},"Users"))),r.a.createElement(y,null))))},$=t(5),k=t(4);function D(){var e=Object(i.a)(["\n  query kpi(\n    $dateFrom: Date\n    $dateTo: Date\n    ) {\n    kpiSummary(\n      dateFrom: $dateFrom\n      dateTo: $dateTo\n      ) {\n      name\n      count\n      natureName\n    }\n  }\n"]);return D=function(){return e},e}function x(){var e=Object(i.a)(["\n  query getLocSummary(\n    $dateFrom: Date\n    $dateTo: Date\n    ) {\n    locationSummary(\n      dateFrom: $dateFrom\n      dateTo: $dateTo\n      ) {\n      locName\n      locCount\n    }\n  }\n"]);return x=function(){return e},e}function T(){var e=Object(i.a)(["\n  query statusSummary(\n    $dateFrom: Date\n    $dateTo: Date\n    ) {\n    statusSummary(\n      dateFrom: $dateFrom\n      dateTo: $dateTo\n      ) {\n      name\n      count\n    }\n  }\n"]);return T=function(){return e},e}function q(){var e=Object(i.a)(["\n  query natureSummary(\n    $dateFrom: Date\n    $dateTo: Date\n    ) {\n    natureSummary(\n      dateFrom: $dateFrom\n      dateTo: $dateTo\n      ) {\n      name\n      status\n      count\n    }\n  }\n"]);return q=function(){return e},e}var F=Object(s.b)(q()),I=Object(s.b)(T()),A=Object(s.b)(x()),P=Object(s.b)(D()),L=t(25),M=t.n(L),_=function(e){var a=e.graphId,t=e.meta,l=e.title,c=e.extra,o=void 0===c?null:c,m=e.type,i=void 0===m?"bar":m,s=e.stacked,u=void 0!==s&&s;return Object(n.useEffect)((function(){var e={datasets:t.data,labels:t.labels};console.log(e);var n={legend:{display:window.screen.width>800,position:"top"},plugins:{datalabels:{display:!1}},hover:{mode:"index",intersect:!1},tooltips:{displayColors:!0,callbacks:{mode:"x"}},scales:{xAxes:[{stacked:u,gridLines:{display:!1}}],yAxes:[{stacked:u,ticks:{beginAtZero:t.beginAtZero||!1,callback:function(e){return e.toLocaleString()},userCallback:function(e,a,t){if(Math.floor(e)===e)return e}},type:"linear"}]}};new M.a(document.getElementById(a),{type:i,data:e,options:n})}),[]),r.a.createElement("div",{className:"graph-container bg-white card ".concat(o||"")},r.a.createElement("h6",{className:"pl-1"},l),r.a.createElement("div",null,r.a.createElement("canvas",{id:a,className:"graph p-1",style:{}})))},R=(t(41),t(48)),U=t(47),V=t.n(U),Y={randomColor:function(){for(var e="#",a=0;a<6;a++)e+="0123456789ABCDEF"[Math.floor(16*Math.random())];return e},randomColors:function(e){var a=this;return Object(R.a)(Array(e).keys()).map((function(){return a.randomColor()}))},contrastColors:function(e){return e.map((function(e){return V()(e)}))}};var Q=function(e){var a=e.filter;C();var t=Object(m.a)(F,{variables:Object($.a)({},a)}),l=Object(k.a)(t,2),c=l[0],o=l[1],i=o.loading,s=o.data,u=o.error;if(Object(n.useEffect)((function(){var e=new AbortController;return console.log(a),c(),function(){e.abort()}}),[a]),i)return null;if(u)return null;if(!s)return null;console.log(s),console.log(s.natureSummary);var d=s.natureSummary.map((function(e){return e.name})).filter((function(e,a,t){return t.indexOf(e)===a})),b={data:[{name:"Not Assigned",count:0},{name:"Assigned",count:0},{name:"Completed",count:0},{name:"Feedback Sent",count:0}].map((function(e){return{label:e.name,backgroundColor:Y.randomColor(),data:d.map((function(a){var t=s.natureSummary.find((function(t){return t.name===a&&t.status===e.name}));return t?t.count:0}))}})),labels:d.map((function(e){return e})),beginAtZero:!0};return r.a.createElement(_,{stacked:!0,meta:b,title:"Complaints Nature Summary",graphId:"complaints-nature-summary"})},B=function(e){var a=e.meta,t=e.graphId,l=e.title,c=e.colors,o=e.onDataClick;return Object(n.useEffect)((function(){var e=c||Y.randomColors(a.data.length),n={legend:{position:"right"},plugins:{datalabels:{formatter:function(e,a){var t=0;return a.chart.data.datasets[0].data.map((function(e){t+=e})),(100*e/t).toFixed(0)+"%"},color:Y.contrastColors(e)}},onClick:function(e,t){if(t&&t.length&&o){var n=a.data.slice(t[0]._index,t[0]._index+1)[0];o(n)}}},r={datasets:[{data:a.data.map((function(e){return e.value})),backgroundColor:e}],labels:a.data.map((function(e){return e.name}))},l=new M.a(document.getElementById(t),{type:"pie",data:r,options:n});console.log(l)}),[]),r.a.createElement("div",{className:"graph-container bg-white card p-2"},r.a.createElement("h6",{className:"pl-1"},l),r.a.createElement("div",null,r.a.createElement("canvas",{id:t,className:"graph p-1",style:{}})))};var J=function(e){var a=e.filter;C();var t=Object(m.a)(I,{variables:Object($.a)({},a)}),l=Object(k.a)(t,2),c=l[0],o=l[1],i=o.loading,s=o.data,u=o.error;if(Object(n.useEffect)((function(){var e=new AbortController;return console.log(a),c(),function(){e.abort()}}),[a]),i)return null;if(u)return null;if(!s)return null;console.log(s);var d={data:s.statusSummary.map((function(e){return{name:e.name,value:e.count}}))};return r.a.createElement(B,{meta:d,title:"Complaints Status Summary",graphId:"complaints-status-summary"})};var z=function(e){var a=e.filter;C();var t=Object(m.a)(A,{variables:Object($.a)({},a)}),l=Object(k.a)(t,2),c=l[0],o=l[1],i=o.loading,s=o.data,u=o.error;if(Object(n.useEffect)((function(){var e=new AbortController;return console.log(a),c(),function(){e.abort()}}),[a]),i)return null;if(u)return null;if(!s)return null;console.log(s);var d={data:s.locationSummary.map((function(e){return{name:e.locName,value:e.locCount}}))};return r.a.createElement(B,{meta:d,title:"Complaints Location Summary",graphId:"complaints-location-summary"})};var Z=function(e){var a=e.filter;C();var t=Object(m.a)(P,{variables:Object($.a)({},a)}),l=Object(k.a)(t,2),c=l[0],o=l[1],i=o.loading,s=o.data,u=o.error;if(Object(n.useEffect)((function(){var e=new AbortController;return console.log(a),c(),function(){e.abort()}}),[a]),i)return null;if(u)return null;if(!s)return null;console.log(s);var d=[{name:"1 week",count:0},{name:"2 weeks",count:0},{name:"3-4 weeks",count:0},{name:"5-6 weeks",count:0},{name:"7-8 weeks",count:0},{name:"Above 8 weeks",count:0}];console.log(s.kpiSummary);var b={data:s.kpiSummary.map((function(e){return e.natureName})).filter((function(e,a,t){return t.indexOf(e)===a})).map((function(e){return{label:e,backgroundColor:Y.randomColor(),data:d.map((function(a){var t=s.kpiSummary.find((function(t){return t.natureName===e&&t.name===a.name}));return t?t.count:0}))}})),labels:d.map((function(e){return e.name})),beginAtZero:!0};return r.a.createElement(_,{stacked:!0,meta:b,title:"Complaints KPI",graphId:"complaints-kpi-summary"})},W=t(11),G=t(22);var H=function(e){var a=e.label,t=e.name,n=e.help,l=e.type,c=void 0===l?"text":l,o=e.cls,m=Object(G.a)(e,["label","name","help","type","cls"]);return r.a.createElement("div",{className:"input-wrap ".concat(o||"")},r.a.createElement("label",{htmlFor:t},a),"textarea"===c?r.a.createElement("textarea",Object.assign({name:t,id:t},m)):r.a.createElement("input",Object.assign({type:c,name:t,id:t},m)),n&&r.a.createElement("span",{className:"input-help"},n))};var K=function(e){var a=e.label,t=e.name,n=e.query,l=e.options,c=void 0===l?[]:l,o=Object(G.a)(e,["label","name","query","options"]),i=Object(m.c)(n?n.name:v,{skip:null===n}),s=i.loading,u=i.data,d=i.error;return s||d?null:(u&&n&&(c=u[n.data]),r.a.createElement("div",{className:"input-wrap"},r.a.createElement("label",{htmlFor:t},a),r.a.createElement("select",Object.assign({name:t,id:t},o),r.a.createElement("option",{value:""},"---Select---"),c.map((function(e){return r.a.createElement("option",{key:e.id,value:e.id},e.name)})))))};var X=function(e){var a=e.fields,t=e.handleChange,n=e.handleSubmit,l=(e.filter,e.handleExport),c=e.filterLabel;return r.a.createElement("div",{className:"filter-export  w-100"},r.a.createElement("form",{className:"form d-flex align-bottom",onSubmit:n},r.a.createElement("div",{className:"inline-fields"},a.map((function(e,a){return e.type&&"select"===e.type?r.a.createElement(r.a.Fragment,null,r.a.createElement(K,Object.assign({key:e.name},e,{onChange:t}))):r.a.createElement(r.a.Fragment,null,r.a.createElement(H,Object.assign({key:e.name},e,{onChange:t})))}))),r.a.createElement("div",{className:"d-flex"},r.a.createElement("button",{name:"filter"},c||"Filter"),l&&r.a.createElement("button",{className:"ml-1",name:"export",type:"button",onClick:l},"Export"))))},ee=function(e){var a=arguments.length>1&&void 0!==arguments[1]&&arguments[1],t=new Date(e),n=""+(t.getMonth()+1),r=""+t.getDate(),l=t.getFullYear(),c=t.getHours(),o=t.getMinutes();n.length<2&&(n="0"+n),r.length<2&&(r="0"+r),c<10&&(c="0"+c),o<10&&(o="0"+o);var m=[l,n,r].join("-"),i="".concat(c,":").concat(o<10?"0"+o:o,":00.00"),s=a?m+"T"+i:m;return s};var ae=function(e){var a=e.handleSubmit,t=(e.handleExport,e.filter),l=void 0===t?{}:t;console.log(l);var c=Object(n.useState)(l),o=Object(k.a)(c,2),m=o[0],i=o[1],s=new Date;s.setDate(s.getDate()-30);var u=[{name:"dateFrom",label:"From",type:"date",defaultValue:l.dateFrom||ee(s)},{name:"dateTo",label:"To",type:"date",defaultValue:l.dateTo||ee(Date.now())}];return r.a.createElement(X,{handleSubmit:function(e){e.preventDefault(),a(m)},fields:u,handleChange:function(e){var a=e.target,t=a.value,n=a.name;i(Object($.a)(Object($.a)({},m),{},Object(W.a)({},n,t||null)))},filterLabel:"Refresh"})};var te=function(){var e=Object(n.useState)(new Map),a=Object(k.a)(e,2),t=a[0],l=a[1];return r.a.createElement("div",{className:"dashboard-container"},r.a.createElement("div",{className:"toolbar"},r.a.createElement(ae,{handleSubmit:function(e){l(Object($.a)({},e))},filter:t})),r.a.createElement("div",{className:"dashboard"},r.a.createElement(J,{filter:t}),r.a.createElement(z,{filter:t}),r.a.createElement(Q,{filter:t}),r.a.createElement(Z,{filter:t})))},ne=t(16);var re=function(e){var a=e.columns,t=e.data,n=e.idCol,l=void 0===n?"id":n;return r.a.createElement("div",{className:"table-container"},r.a.createElement("table",{className:"table-scrollable"},r.a.createElement("thead",null,r.a.createElement("tr",null,a.map((function(e){return r.a.createElement("th",{key:e.name},e.label)})))),r.a.createElement("tbody",null,t.map((function(e){return r.a.createElement("tr",{key:e[l]},a.map((function(a){return r.a.createElement("td",{key:a.name,className:a.className},a.render?a.render(e):e[a.name])})))})))))},le=function(e){var a=e.name,t=e.extra,n=e.text;return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"mat-icon material-icons".concat(t?" "+t:"")},a),n&&r.a.createElement("span",null,n))};function ce(){var e=Object(i.a)(["\n  query getStatuses {\n    statuses {\n      id\n      name\n    }\n  }\n"]);return ce=function(){return e},e}function oe(){var e=Object(i.a)(["\n  mutation sendFeedback(\n    $attachments: [FileType]\n    $id: ID!\n    $email: String!\n    $remarks: String\n  ) {\n    feedback(\n      attachments: $attachments\n      id: $id\n      email: $email\n      remarks: $remarks\n    ) {\n      complaint {\n        id\n        clientName\n      }\n    }\n  }\n"]);return oe=function(){return e},e}function me(){var e=Object(i.a)(["\n  mutation updateDetails(\n    $id: ID!\n    $rca: String!\n    $results: String!\n    $financialImpact: String!\n    $costCenter: String!\n    $responsiblePerson: String!\n    $attachments: [FileType]\n  ) {\n    updateComplaint(\n      id: $id\n      rca: $rca\n      results: $results\n      financialImpact: $financialImpact\n      costCenter: $costCenter\n      responsiblePerson: $responsiblePerson\n      attachments: $attachments\n    ) {\n      complaint {\n        id\n        details\n      }\n    }\n  }\n"]);return me=function(){return e},e}function ie(){var e=Object(i.a)(["\n  mutation assignTo($id: ID!, $userId: ID!) {\n    assignComplaint(id: $id, userId: $userId) {\n      complaint {\n        id\n        details\n        assignedTo {\n          id\n          username\n        }\n      }\n    }\n  }\n"]);return ie=function(){return e},e}function se(){var e=Object(i.a)(["\n  mutation createComplaint(\n    $details: String!\n    $clientName: String!\n    $openDate: DateTime!\n    $nature: ID!\n    $location: ID!\n    $actionPlan: String!\n    $attachments: [FileType]\n  ) {\n    registerComplaint(\n      details: $details\n      clientName: $clientName\n      nature: $nature\n      location: $location\n      openDate: $openDate\n      actionPlan: $actionPlan\n      attachments: $attachments\n    ) {\n      complaint {\n        id\n      }\n    }\n  }\n"]);return se=function(){return e},e}function ue(){var e=Object(i.a)(["\n  query getLocations {\n    locations {\n      id\n      name\n    }\n  }\n"]);return ue=function(){return e},e}function de(){var e=Object(i.a)(["\n  query getComplAttachments($complaint_id: ID!) {\n    complaintAttachments(complaintId: $complaint_id) {\n      id\n      file\n    }\n  }\n"]);return de=function(){return e},e}function be(){var e=Object(i.a)(["\n  query getNatures {\n    natures {\n      id\n      name\n    }\n  }\n"]);return be=function(){return e},e}function fe(){var e=Object(i.a)(["\n  query getComplaint($id: ID!) {\n    complaint(id: $id) {\n      id\n      clientName\n      openDate\n      status\n      details\n      rca\n      actionPlan\n      results\n      financialImpact\n      costCenter\n      responsiblePerson\n      dueDate\n      nature {\n        id\n        name\n      }\n      location {\n        id\n        name\n      }\n      assignedTo {\n        id\n        username\n      }\n      assignedAt\n      closedBy {\n        id\n        username\n      }\n      closeDate\n    }\n  }\n"]);return fe=function(){return e},e}function pe(){var e=Object(i.a)(["\n  query fetchComplaints(\n    $pageNo: Int\n    $pageSize: Int\n    $clientName: String\n    $location: Int\n    $nature: Int\n    $status: String\n    $dateFrom: Date\n    $dateTo: Date\n  ) {\n    complaints(\n      pageNo: $pageNo\n      pageSize: $pageSize\n      clientName: $clientName\n      location: $location\n      nature: $nature\n      status: $status\n      dateFrom: $dateFrom\n      dateTo: $dateTo\n    ) {\n      id\n      clientName\n      location {\n        id\n        name\n      }\n      openDate\n      status\n      details\n      rca\n      actionPlan\n      results\n      financialImpact\n      costCenter\n      responsiblePerson\n      dueDate\n      closeDate\n      assignedTo {\n        id\n        username\n      }\n      nature {\n        id\n        name\n      }\n    }\n  }\n"]);return pe=function(){return e},e}var Ee=Object(s.b)(pe()),ge=Object(s.b)(fe()),ve=Object(s.b)(be()),Oe=Object(s.b)(de()),he=Object(s.b)(ue()),je=Object(s.b)(se()),Ne=Object(s.b)(ie()),ye=Object(s.b)(me()),Se=Object(s.b)(oe()),Ce=Object(s.b)(ce()),we=t(32),$e=function(e,a){for(var t=[],n=e.target.files,r=function(e){var r=new FileReader,l=n[e];r.addEventListener("load",(function(){var e=r.result;t.push({filename:l.name,data:e}),t.length===n.length&&function(e){a(e)}(t)})),r.readAsDataURL(l)},l=0;l<n.length;l++)r(l)},ke={pageSize:10,pageNo:1};var De=function(e){Object(we.a)(e);var a=Object(m.c)(ve),t=Object(m.c)(he),l=Object(n.useState)(null),c=Object(k.a)(l,2),i=c[0],s=c[1],u=Object(n.useState)(new Map),d=Object(k.a)(u,2),b=d[0],f=d[1],p=Object(m.b)(je),E=Object(k.a)(p,2),g=E[0],v=E[1].loading,O=a.data?a.data.natures:[],h=t.data?t.data.locations:[],j=Object(n.useState)([]),N=Object(k.a)(j,2),y=N[0],C=N[1];function w(e){var a=e.target,t=a.value,n=a.name;f(Object($.a)(Object($.a)({},b),{},Object(W.a)({},n,t)))}var D={type:"textarea",onChange:w,required:"required",maxLength:"200",help:"Max 200 characters"};return i?r.a.createElement(S.a,{to:i}):r.a.createElement("div",null,r.a.createElement("div",{className:"toolbar"},r.a.createElement("div",{className:"titlebar"},r.a.createElement(o.b,{to:"/complaints",className:"btn btn-light mr-1"},r.a.createElement(le,{name:"keyboard_arrow_left"})),r.a.createElement("h5",null,"Register New Complaint"))),v&&r.a.createElement("p",null,"Sending ...."),r.a.createElement("form",{className:"form",onSubmit:function(e){e.preventDefault(),g({variables:Object($.a)(Object($.a)({},b),{},{attachments:y,openDate:"".concat(b.openDate,"T00:00+00:00")}),refetchQueries:function(){return[{query:Ee,variables:ke}]},awaitRefetchQueries:!0}).then((function(){return s("/complaints")}),(function(e){return console.log("Error: ",e)}))}},r.a.createElement("div",{className:"form-grid-2"},r.a.createElement("div",null,r.a.createElement(H,{name:"clientName",label:"Client Name",onChange:w,required:!0}),r.a.createElement(K,{name:"location",label:"Location",options:h,onChange:w,required:!0}),r.a.createElement(K,{name:"nature",label:"Nature",options:O,onChange:w,required:!0}),r.a.createElement(H,{name:"openDate",label:"Open Date",type:"date",onChange:w,required:!0,max:(new Date).toISOString().split("T")[0]})),r.a.createElement("div",{className:"register-right"},r.a.createElement(H,{name:"details",label:"Details",type:"textarea",onChange:w,required:!0,maxLength:"300",help:"Max 300 characters",cls:"large"}),r.a.createElement(H,Object.assign({name:"actionPlan",label:"Action Plan"},D)),r.a.createElement(H,{name:"attachments",type:"file",label:"Attachments",multiple:!0,onChange:function(e){return $e(e,(function(e){return C(e)}))}}))),r.a.createElement("div",{className:"form-footer"},r.a.createElement("button",null,"Submit"))))};var xe=function(e){var a=e.onClose,t=e.title,n=e.children,l=(e.posx,e.posy,Object(G.a)(e,["onClose","title","children","posx","posy"]));return c.a.createPortal(r.a.createElement("div",Object.assign({className:"modal display-block"},l),r.a.createElement("div",{className:"modal-main"},r.a.createElement("div",{className:"modal-header"},t?r.a.createElement("h5",{className:"modal-title"},t):r.a.createElement("span",null),r.a.createElement("div",{className:"btn-group"},r.a.createElement("button",{type:"button",className:"btn btn-no-bg text-warning m-1 close-button",onClick:a},r.a.createElement(le,{name:"close"})))),r.a.createElement("div",{className:"modal-content"},n))),document.getElementById("portal"))};var Te=function(e){var a=e.complaint,t=e.onComplete,l=Object(m.c)(O),c=Object(n.useState)(new Map),o=Object(k.a)(c,2),i=o[0],s=o[1],u=Object(m.b)(Ne),d=Object(k.a)(u,1)[0],b=l.data?l.data.users.map((function(e){return Object($.a)(Object($.a)({},e),{},{name:e.username})})):[];return console.log(a),r.a.createElement("div",null,r.a.createElement("h5",null,"Assign Complaint To User"),r.a.createElement("form",{className:"form",onSubmit:function(e){e.preventDefault(),d({variables:Object($.a)(Object($.a)({},i),{},{id:a.id}),refetchQueries:[{query:Ee}]}).then((function(){return t()}),(function(e){return console.log("Error: ",e)}))}},r.a.createElement("div",null,r.a.createElement(K,{name:"userId",label:"Assign To",onChange:function(e){var a=e.target,t=a.value,n=a.name;s(Object($.a)(Object($.a)({},i),{},Object(W.a)({},n,t)))},required:!0,options:b})),r.a.createElement("div",{className:"form-footer"},r.a.createElement("button",null,"Submit"))))};var qe=Object(S.h)((function(e){var a=e.match;C();var t=Object(n.useState)(null),l=Object(k.a)(t,2),c=l[0],i=l[1],s=Object(n.useState)(new Map),u=Object(k.a)(s,2),d=u[0],b=u[1],f=Object(n.useState)([]),p=Object(k.a)(f,2),E=p[0],g=p[1],v=Object(m.c)(ge,{variables:{id:a.params.id}}),O=v.loading,h=v.error,j=v.data,N=Object(m.b)(ye),y=Object(k.a)(N,1)[0];if(O)return r.a.createElement("p",null,"Loading...");if(h)return r.a.createElement("p",null,"Error :(");var w=j.complaint,D={type:"textarea",onChange:function(e){var a=e.target,t=a.value,n=a.name;b(Object($.a)(Object($.a)({},d),{},Object(W.a)({},n,t)))},required:"required",maxLength:"200",help:"Max 200 characters"};return c?r.a.createElement(S.a,{to:c}):r.a.createElement("div",{className:"form-wrap"},r.a.createElement("div",{className:"toolbar"},r.a.createElement("div",{className:"titlebar"},r.a.createElement(o.b,{to:"/complaints",className:"btn btn-light mr-1"},r.a.createElement(le,{name:"keyboard_arrow_left"})),r.a.createElement("h5",null,"Fill complain analysis/resolution"))),r.a.createElement("form",{className:"form form-flex v-scroll",onSubmit:function(e){e.preventDefault();var a=new Map;Object.keys(w).forEach((function(e){d[e]||(a[e]=w[e])})),y({variables:Object($.a)(Object($.a)(Object($.a)({},d),a),{},{attachments:E,id:w.id}),refetchQueries:[{query:Ee}]}).then((function(){return i("/complaints")}),(function(e){return console.log("Error: ",e)}))}},r.a.createElement("div",{className:"form-fields"},r.a.createElement("p",null,r.a.createElement("b",null,"Details:")," ",w.details),r.a.createElement(H,Object.assign({name:"rca",label:"Root Cause Analysis"},D,{defaultValue:w.rca})),r.a.createElement(H,Object.assign({name:"results",label:"Results"},D,{defaultValue:w.results,maxLength:"500",help:"Max 500 characters",rows:"4"})),r.a.createElement(H,Object.assign({name:"financialImpact",label:"Financial Impact"},D,{defaultValue:w.financialImpact})),r.a.createElement(H,Object.assign({name:"costCenter",label:"Cost Center"},D,{defaultValue:w.costCenter})),r.a.createElement(H,Object.assign({name:"responsiblePerson",label:"Responsible Person"},D,{defaultValue:w.responsiblePerson})),r.a.createElement(H,{name:"attachments",type:"file",label:"Attachments",multiple:!0,onChange:function(e){return $e(e,(function(e){return g(e)}))}})),r.a.createElement("div",{className:"form-footer"},r.a.createElement("button",null,"Submit"))))}));var Fe=function(e){var a=e.pageNo,t=e.onPageChanged,n=e.lastPage;return r.a.createElement("ul",{className:"pagination"},r.a.createElement("li",{className:"btn-wrap"},r.a.createElement("button",{onClick:function(){t&&t(a>1?a-1:1)},disabled:a<=1},r.a.createElement(le,{name:"keyboard_arrow_left"})," Previous")),r.a.createElement("li",null,r.a.createElement("span",null,"Page ",a)),r.a.createElement("li",{className:"btn-wrap"},r.a.createElement("button",{onClick:function(){t&&t(a+1)},disabled:n},"Next ",r.a.createElement(le,{name:"keyboard_arrow_right"}))))};var Ie=function(e){var a=e.complaint,t=Object(m.b)(Se),l=Object(k.a)(t,1)[0],c=Object(n.useState)(null),o=Object(k.a)(c,2),i=o[0],s=o[1],u=Object(n.useState)(null),d=Object(k.a)(u,2),b=d[0],f=d[1],p=Object(n.useState)(null),E=Object(k.a)(p,2),g=E[0],v=E[1],O=Object(n.useState)([]),h=Object(k.a)(O,2),j=h[0],N=h[1];return i?r.a.createElement(S.a,{to:i}):r.a.createElement("div",null,r.a.createElement("form",{className:"form",onSubmit:function(e){e.preventDefault();var t={id:a.id,attachments:j,email:b,remarks:g};console.log(t),l({variables:t,refetchQueries:[{query:Ee}]}).then((function(){return s("/complaints")}),(function(e){return console.log("Error: ",e)}))},encType:"multipart/form-data"},r.a.createElement("div",null,r.a.createElement(H,{name:"email",type:"email",label:"Customer Email",onChange:function(e){return f(e.target.value)},required:!0}),r.a.createElement(H,{name:"remarks",type:"textarea",label:"Remarks",onChange:function(e){return v(e.target.value)},required:!0}),r.a.createElement(H,{name:"attachments",type:"file",label:"Attachments",multiple:!0,onChange:function(e){return $e(e,(function(e){return N(e)}))},required:!0})),r.a.createElement("div",{className:"form-footer"},r.a.createElement("button",{className:"p-1"},"Send Feedback"))))},Ae={DEV:{baseUrl:"http://localhost:8000/api",ROOT:"http://localhost:8000"},PROD:{baseUrl:"/api",ROOT:""}},Pe=Ae.PROD.baseUrl,Le=Ae.PROD.ROOT;var Me=function(e){var a=e.doc;console.log(a);var t=a.file.split("/"),n=t[t.length-1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("span",{className:"text-ellipsis"},n),r.a.createElement("a",{href:"".concat(Le,"/media/").concat(a.file),className:"borded-link",download:!0},r.a.createElement(le,{name:"arrow_downward"})))};var _e=function(e){var a=e.complaint_id,t=Object(m.c)(Oe,{variables:{complaint_id:a}}),n=t.loading,l=t.error,c=t.data;if(n||l)return null;var o=c.complaintAttachments;return r.a.createElement("ul",{className:"attachments mb-1"},r.a.createElement("li",null,r.a.createElement("b",null,"Attachments")),o.length?o.map((function(e){return r.a.createElement("li",{key:e.id},r.a.createElement(Me,{doc:e}))})):r.a.createElement("li",null,"None"))},Re=t(62),Ue=t(63);var Ve=Object(S.h)((function(e){var a=e.match;C();var t=Object(n.useRef)(null),l=Object(n.useState)(null),c=Object(k.a)(l,2),i=c[0],s=c[1],u=Object(n.useState)(null),d=Object(k.a)(u,2),b=d[0],f=d[1],p=Object(m.c)(ge,{variables:{id:a.params.id}}),E=p.loading,g=p.error,v=p.data;if(g&&console.error(g),E)return r.a.createElement("p",null,"Loading...");if(g)return r.a.createElement("p",null,"Error :(");var O,h,j=v.complaint,N=j.id,y=j.clientName,S=j.location,w=j.nature,$=j.openDate,D=j.details,x=j.actionPlan,T=j.closeDate,q=j.costCenter,F=j.financialImpact,I=j.rca,A=j.responsiblePerson,P=j.results,L=j.status,M=j.assignedTo,_=j.assignedAt,R=j.closedBy,U=function(e){return e?(e.indexOf("T")&&(e=e.split("T")[0]),Re(e).format("DD/MM/YYYY")):null};return r.a.createElement("div",{className:"details"},r.a.createElement("div",{className:"toolbar"},r.a.createElement("div",{className:"titlebar"},r.a.createElement(o.b,{to:"/complaints",className:"btn btn-light mr-1"},r.a.createElement(le,{name:"keyboard_arrow_left"})),r.a.createElement("h5",null,"Complete Complaint Information"))),r.a.createElement("div",{className:"details-grid",ref:t},r.a.createElement("div",{className:"grid-form-details"},r.a.createElement("div",null,r.a.createElement("label",null,"Client Name"),r.a.createElement("p",null,y)),r.a.createElement("div",null,r.a.createElement("label",null,"Location"),r.a.createElement("p",null,S.name)),r.a.createElement("div",null,r.a.createElement("label",null,"Nature"),r.a.createElement("p",null,w.name)),r.a.createElement("div",null,r.a.createElement("label",null,"Open Date"),r.a.createElement("p",null,U($))),r.a.createElement("div",{className:"span"},r.a.createElement("label",null,"Details"),r.a.createElement("p",null,D)),r.a.createElement("div",null,r.a.createElement("label",null,"Action Plan"),r.a.createElement("p",null,x)),r.a.createElement("div",null,r.a.createElement("label",null,"Root Cause Analysis"),r.a.createElement("p",null,I)),r.a.createElement("div",{className:"span"},r.a.createElement("label",null,"Results"),r.a.createElement("p",null,P)),r.a.createElement("div",{className:"span"},r.a.createElement("label",null,"Financial Impact"),r.a.createElement("p",null,F)),r.a.createElement("div",null,r.a.createElement("label",null,"Cost Center"),r.a.createElement("p",null,q)),r.a.createElement("div",null,r.a.createElement("label",null,"Responsible Person"),r.a.createElement("p",null,A))),r.a.createElement("div",{className:"sidebar mt-1 bg-light"},r.a.createElement("div",{className:"status"},r.a.createElement("label",null,"Status: ",r.a.createElement("span",null,L))),r.a.createElement("ul",null,$&&r.a.createElement("li",null,r.a.createElement(le,{name:"done"}),"On ",U($),", Created"),M&&r.a.createElement("li",null,r.a.createElement(le,{name:"done"}),"On ",U(_),", Assigned to ",M.username),R&&r.a.createElement("li",null,r.a.createElement(le,{name:"done"}),"On ",U(T),", Closed by ",R.username),r.a.createElement("li",{className:"kpi"},"KPI:",r.a.createElement("span",{className:"ml-1"},r.a.createElement("b",null,(O=$,h=T,console.log("Open: ".concat(O),"Close: ".concat(h)),h||(h=Re().format("YYYY-MM-DD")),O.indexOf("T")&&(O=O.split("T")[0]),h.indexOf("T")&&(h=h.split("T")[0]),console.log("Open: ".concat(O),"Close: ".concat(h)),Re(h).diff(Re(O),"day")))," day(s)"))),r.a.createElement(_e,{complaint_id:N}),"COMPLETED"===L&&r.a.createElement("button",{className:"send-feedback btn ripple",onClick:function(e){var a=e.target;console.log(a),Ue(t.current,{scrollY:-window.scrollY}).then((function(e){console.log(e);var a=e.toDataURL("image/png");f(a),s(!0)}))}},r.a.createElement(le,{name:"mail_outline",text:"Send Feedback To Customer"})))),i&&r.a.createElement(xe,{title:"Feedback To: ".concat(j.clientName),onClose:function(){return s(!1)}},r.a.createElement(Ie,{complaint:j,img:b,onComplete:function(){return s(!1)}})))}));var Ye=function(e){var a=e.handleSubmit,t=e.handleExport,l=e.filter,c=void 0===l?{}:l;console.log(c);var o=Object(n.useState)(c),m=Object(k.a)(o,2),i=m[0],s=m[1],u=[{name:"clientName",label:"Client Name"},{name:"location",label:"Location",type:"select",query:{name:he,data:"locations"},defaultValue:c.location},{name:"nature",label:"Nature",type:"select",query:{name:ve,data:"natures"},defaultValue:c.nature},{name:"status",label:"Status",type:"select",query:{name:Ce,data:"statuses"},defaultValue:c.status},{name:"dateFrom",label:"From",type:"date",defaultValue:c.dateFrom||ee(Date.now())},{name:"dateTo",label:"To",type:"date",defaultValue:c.dateTo||ee(Date.now())}];return r.a.createElement(X,{handleSubmit:function(e){e.preventDefault(),a(i)},fields:u,handleChange:function(e){var a=e.target,t=a.value,n=a.name;s(Object($.a)(Object($.a)({},i),{},Object(W.a)({},n,t||null)))},handleExport:function(e){e.preventDefault(),t(i)}})};var Qe=function(){C();var e=Object(n.useState)(1),a=Object(k.a)(e,2),t=a[0],l=a[1],c=Object(n.useState)(new Map),i=Object(k.a)(c,2),s=i[0],u=i[1],d=Object(m.a)(Ee,{variables:Object($.a)({pageSize:10,pageNo:t},s)}),b=Object(k.a)(d,2),f=b[0],p=b[1],E=p.loading,g=p.data,v=p.error;Object(n.useEffect)((function(){var e=new AbortController;return console.log("Start"),f(),function(){e.abort()}}),[t,s]);var O=Object(n.useState)(!1),h=Object(k.a)(O,2),j=h[0],N=h[1],y=Object(n.useState)(null),w=Object(k.a)(y,2),D=w[0],x=w[1];if(E)return r.a.createElement("p",null,"Loading...");if(v)return r.a.createElement("p",null,"Error :(");var T=[{name:"id",label:"ID"},{name:"clientName",label:"Client Name"},{name:"location_name",label:"Location"},{name:"openDate",label:"Open Date"},{name:"nature_name",label:"Nature of Complaint"},{name:"status",label:"Status"},{name:"assigned_to",label:"Assigned To",render:function(e){return e.assignedTo?r.a.createElement("span",null,e.assignedTo.username):r.a.createElement("button",{onClick:function(){N(!0),x(e)}},"Assign")}},{name:"details",label:"Details",className:"col-ellipsis"},{name:"updateDetails",label:"",render:function(e){return"ASSIGNED"===e.status?r.a.createElement(o.b,{className:"btn btn-light p-1 d-flex align-left",to:"/complaints/update/".concat(e.id)},r.a.createElement(le,{name:"settings",text:"Complete"})):null}},{name:"viewDetails",render:function(e){return r.a.createElement(o.b,{to:"/complaints/view/".concat(e.id),className:"d-flex"},r.a.createElement(le,{name:"unfold_more"}))}}],q=function(e){var a=Date.parse(e);return new Date(a).toLocaleDateString("en-GB")},F=g?g.complaints.map((function(e){return Object($.a)(Object($.a)({},e),{},{nature_name:e.nature.name,location_name:e.location?e.location.name:"",openDate:q(e.openDate)})})):[];return r.a.createElement(r.a.Fragment,null,r.a.createElement(S.b,{path:"/complaints",exact:!0},r.a.createElement("div",{className:"toolbar"},r.a.createElement("h5",null,"List of complaints"),r.a.createElement(o.b,{className:"d-flex btn has-left-icon",to:"/complaints/new-complaint"},r.a.createElement(le,{name:"add",text:"New Complaint"}))),r.a.createElement("hr",null),r.a.createElement("div",{className:"toolbar"},g&&r.a.createElement(Ye,{handleSubmit:function(e){console.log(e);for(var a=new Map,t=0,n=Object.entries(e);t<n.length;t++){var r=Object(k.a)(n[t],2),c=r[0],o=r[1];o&&(a[c]=o)}console.log("Params: ",a),u(a),l(1)},filter:s,handleExport:function(e){for(var a=new Map,t=0,n=Object.entries(e);t<n.length;t++){var r=Object(k.a)(n[t],2),l=r[0],c=r[1];c&&(a[l]=c)}var o=Object.keys(a).map((function(e){return e+"="+a[e]})).join("&");fetch("".concat(Pe,"/export-complaints?").concat(o)).then((function(e){return e.blob()})).then((function(e){var a=window.URL.createObjectURL(e),t=document.createElement("a");t.href=a,t.download="Export.xlsx",document.body.appendChild(t),t.click(),t.remove()}))}})),r.a.createElement(re,{columns:T,data:F}),g&&r.a.createElement(Fe,{pageNo:t,onPageChanged:function(e){l(e)},lastPage:g.complaints.length<10})),r.a.createElement(S.b,{path:"/complaints/new-complaint",exact:!0},r.a.createElement(De,null)),r.a.createElement(S.b,{path:"/complaints/update/:id",exact:!0},r.a.createElement(qe,null)),r.a.createElement(S.b,{path:"/complaints/view/:id",exact:!0},r.a.createElement(Ve,null)),j&&r.a.createElement(xe,{title:D.clientName,onClose:function(){return N(!1)}},r.a.createElement(Te,{complaint:D,onComplete:function(){return N(!1)}})))};var Be=function(){var e=Object(n.useState)(null),a=Object(k.a)(e,2),t=a[0],l=a[1],c=Object(n.useState)(new Map),i=Object(k.a)(c,2),s=i[0],u=i[1],d=Object(m.b)(h),b=Object(k.a)(d,2),f=b[0],p=b[1].loading;function E(e){var a=e.target,t=a.value,n=a.name;u(Object($.a)(Object($.a)({},s),{},Object(W.a)({},n,t)))}return t?r.a.createElement(S.a,{to:t}):r.a.createElement("div",null,r.a.createElement("div",{className:"toolbar"},r.a.createElement("div",{className:"titlebar"},r.a.createElement(o.b,{to:"/users",className:"btn btn-light mr-1"},r.a.createElement(le,{name:"keyboard_arrow_left"})),r.a.createElement("h5",null,"Register New User"))),p&&r.a.createElement("p",null,"Sending ...."),r.a.createElement("form",{className:"form form-medium",onSubmit:function(e){e.preventDefault(),f({variables:Object($.a)({},s),refetchQueries:[{query:O},{query:v}]}).then((function(){return l("/users")}),(function(e){return console.log("Error: ",e)}))}},r.a.createElement("div",null,r.a.createElement(H,{name:"username",label:"Username",onChange:E,required:!0}),r.a.createElement(H,{name:"email",label:"Email Address",onChange:E,type:"email",required:!0}),r.a.createElement(H,{name:"firstName",label:"First Name",onChange:E,required:!0}),r.a.createElement(H,{name:"lastName",label:"Last Name",onChange:E,required:!0})),r.a.createElement("div",{className:"form-footer"},r.a.createElement("button",null,"Submit"))))};var Je=Object(S.h)((function(e){var a=e.match,t=Object(n.useState)(null),l=Object(k.a)(t,2),c=l[0],i=l[1],s=Object(n.useState)(new Map),u=Object(k.a)(s,2),d=u[0],b=u[1],f=Object(m.b)(h),p=Object(k.a)(f,2),E=p[0];Object(we.a)(p[1]);var g=Object(m.c)(j,{variables:{id:a.params.id}}),N=g.loading,y=g.error,C=g.data;if(N)return r.a.createElement("p",null,"Loading...");if(y)return r.a.createElement("p",null,"Error :(");var w=C.user;function D(e){var a=e.target,t=a.value,n=a.name;b(Object($.a)(Object($.a)({},d),{},Object(W.a)({},n,t)))}return c?r.a.createElement(S.a,{to:c}):r.a.createElement("div",null,r.a.createElement("div",{className:"toolbar"},r.a.createElement("div",{className:"titlebar"},r.a.createElement(o.b,{to:"/users",className:"btn btn-light mr-1"},r.a.createElement(le,{name:"keyboard_arrow_left"})),r.a.createElement("h5",null,"Update User"))),N&&r.a.createElement("p",null,"Sending ...."),r.a.createElement("form",{className:"form form-medium",onSubmit:function(e){e.preventDefault();var a=new Map;Object.keys(w).forEach((function(e){d[e]||(a[e]=w[e])})),E({variables:Object($.a)(Object($.a)(Object($.a)({},d),a),{},{id:w.id}),refetchQueries:[{query:O},{query:v}]}).then((function(){return i("/users")}),(function(e){return console.log("Error: ",e)}))}},r.a.createElement("div",null,r.a.createElement(H,{name:"username",label:"Username",onChange:D,required:!0,defaultValue:w.username,readOnly:!0}),r.a.createElement(H,{name:"email",label:"Email Address",onChange:D,type:"email",required:!0,defaultValue:w.email}),r.a.createElement(H,{name:"firstName",label:"First Name",onChange:D,required:!0,defaultValue:w.firstName}),r.a.createElement(H,{name:"lastName",label:"Last Name",onChange:D,required:!0,defaultValue:w.lastName})),r.a.createElement("div",{className:"form-footer"},r.a.createElement("button",null,"Submit"))))}));var ze=function(){C();var e=Object(m.c)(O),a=e.loading,t=e.error,n=e.data;if(a)return null;if(t)return r.a.createElement("p",null,"Error (:");var l=[{name:"id",label:"ID"},{name:"username",label:"Client Name"},{name:"email",label:"Email"},{name:"name",label:"Full Name"},{name:"actions",label:"",render:function(e){return r.a.createElement("div",null,r.a.createElement("a",{href:"/users/update/".concat(e.id),className:"d-flex align-left"},r.a.createElement(le,{name:"edit",text:"Edit"})))}}],c=n.users.map((function(e){return Object($.a)(Object($.a)({},e),{},{name:e.firstName?"".concat(e.firstName," ").concat(e.lastName):null})}));return r.a.createElement(r.a.Fragment,null,r.a.createElement(S.b,{path:"/users",exact:!0},r.a.createElement("div",{className:"toolbar"},r.a.createElement("h5",null,"List of users"),r.a.createElement(o.b,{className:"d-flex btn btn-light has-left-icon",to:"/users/new-user"},r.a.createElement(le,{name:"add",text:"New User"}))),r.a.createElement(re,{columns:l,data:c})),r.a.createElement(S.b,{path:"/users/new-user",exact:!0},r.a.createElement(Be,null)),r.a.createElement(S.b,{path:"/users/update/:id",exact:!0},r.a.createElement(Je,null)))},Ze={saveToken:function(e,a){sessionStorage.setItem("AccessToken",e),a(!0)},getToken:function(){return sessionStorage.getItem("AccessToken")},removeToken:function(){return sessionStorage.removeItem("AccessToken")}};var We=function(){var e=Object(n.useState)(new Map),a=Object(k.a)(e,2),t=a[0],l=a[1],c=Object(n.useState)(null),o=Object(k.a)(c,2),i=o[0],s=o[1],u=Object(m.b)(g),d=Object(k.a)(u,2),b=d[0],f=d[1].client;function p(e){var a=e.target,n=a.value,r=a.name;l(Object($.a)(Object($.a)({},t),{},Object(W.a)({},r,n)))}return i?r.a.createElement(S.a,{to:i}):r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:"login-page box-shadow"},r.a.createElement("div",{className:"login-header d-flex mb-1 p-1"},r.a.createElement("h3",null,"Twiga - CCMS"),r.a.createElement("img",{src:"/static/images/complaints_register.png",alt:"Image"})),r.a.createElement("form",{className:"form",onSubmit:function(e){e.preventDefault(),f.clearStore(),b({variables:Object($.a)({},t)}).then((function(e){if(e.data){var a=e.data.tokenAuth.token;Ze.saveToken(a,(function(){s("/")}))}}),(function(e){return console.log("Error: ",e)}))}},r.a.createElement("div",{className:"mt-1"},r.a.createElement(H,{name:"username",label:"Username",onChange:p,required:!0}),r.a.createElement(H,{name:"password",label:"Password",type:"password",onChange:p,required:!0})),r.a.createElement("div",{className:"form-footer"},r.a.createElement("button",null,r.a.createElement("span",{className:"mr-1"},"Login"),r.a.createElement(le,{name:"login"}))))))};var Ge=function(e){var a=e.onClose,t=e.title,n=e.children,l=(e.posx,e.posy,Object(G.a)(e,["onClose","title","children","posx","posy"]));return r.a.createElement("div",Object.assign({className:"modal display-block"},l),r.a.createElement("div",{className:"modal-main"},r.a.createElement("div",{className:"modal-header"},t?r.a.createElement("h5",{className:"modal-title"},t):r.a.createElement("span",null),r.a.createElement("div",{className:"btn-group"},r.a.createElement("button",{type:"button",className:"btn text-warning m-1",onClick:a},r.a.createElement(le,{name:"close"})))),r.a.createElement("div",{className:"modal-content"},n)))};function He(){var e=Object(n.useState)(new Map),a=Object(k.a)(e,2),t=a[0],l=a[1],c=Object(n.useState)(),o=Object(k.a)(c,2),i=o[0],s=o[1],u=Object(m.b)(N),d=Object(k.a)(u,2),b=d[0],f=(d[1].loading,Object(n.useState)(null)),p=Object(k.a)(f,2),E=p[0],g=p[1],h=Object(n.useRef)(null);function j(e){e.preventDefault(),b({variables:Object($.a)({},t),refetchQueries:[{query:O},{query:v}]}).then((function(){return g("/login")}),(function(e){s("Authentication failed, check your inputs"),h.current.reset()}))}function y(e){var a=e.target,n=a.value,r=a.name;l(Object($.a)(Object($.a)({},t),{},Object(W.a)({},r,n)))}return console.log(i),E?r.a.createElement(S.a,{to:E}):r.a.createElement("form",{ref:h,className:"form",onSubmit:j},r.a.createElement("div",null,r.a.createElement(H,{name:"password",label:"Current Password",onChange:y,required:!0}),r.a.createElement(H,{name:"newPassword",label:"New Password",onChange:y,required:!0})),r.a.createElement("div",{className:"form-footer"},r.a.createElement("button",{onSubmit:j},"Submit")),r.a.createElement("small",{className:"p-1 error"},i))}function Ke(){var e=Object(n.useState)(),a=Object(k.a)(e,2),t=a[0],l=a[1],c=Object(m.c)(v),o=c.loading,i=c.error,s=c.data;if(o)return r.a.createElement("p",null,"Loading...");if(i)return r.a.createElement("p",null,"Error :(");var u=s.me;return console.log(u),r.a.createElement("div",{className:"user-profile"},r.a.createElement("div",{className:"info"},r.a.createElement("div",{className:"profile-photo"},r.a.createElement("label",{htmlFor:"photo",className:"photo"},r.a.createElement("img",{src:"/static/images/user.jpg",alt:"User"}),r.a.createElement(H,{type:"file",accept:"image/*",id:"photo",name:"photo"}))),r.a.createElement("div",null,r.a.createElement("h3",null,u.username),r.a.createElement("small",null,u.isSuperuser?r.a.createElement("span",null,"Administrator"):r.a.createElement("span",null,"User")))),r.a.createElement("table",null,r.a.createElement("tbody",null,r.a.createElement("tr",null,r.a.createElement("th",null,"First Name"),r.a.createElement("td",null,u.firstName)),r.a.createElement("tr",null,r.a.createElement("th",null,"Last Name"),r.a.createElement("td",null,u.lastName)),r.a.createElement("tr",null,r.a.createElement("th",null,"Email Name"),r.a.createElement("td",null,u.email)))),r.a.createElement("div",{className:"update"},r.a.createElement("button",{onClick:function(){return l(!t)}},"Change password")),t&&r.a.createElement(Ge,{title:"Change My Password",onClose:function(){return l(!1)}},r.a.createElement(He,{onComplete:l})))}var Xe=function(){var e=Ze.getToken();return e?"JWT ".concat(e):""},ea=new s.a({uri:"".concat(Pe,"/graphql"),request:function(e){e.setContext({headers:{Authorization:Xe()}})}});var aa=function(){return r.a.createElement(o.a,null,r.a.createElement(ne.a,{client:ea},r.a.createElement(S.d,null,r.a.createElement(S.b,{path:"/login",exact:!0},r.a.createElement(We,null)),r.a.createElement(S.b,{path:"/"},r.a.createElement(w,null),r.a.createElement("section",{className:"page-content container"},r.a.createElement("div",{className:"content"},r.a.createElement(S.d,null,r.a.createElement(S.b,{path:"/",exact:!0},r.a.createElement(te,null)),r.a.createElement(S.b,{path:"/complaints"},r.a.createElement(Qe,null)),r.a.createElement(S.b,{path:"/users"},r.a.createElement(ze,null)),r.a.createElement(S.b,{path:"/my-profile"},r.a.createElement(Ke,null)))))))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(aa,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[49,1,2]]]);
//# sourceMappingURL=main.cf782edb.chunk.js.map